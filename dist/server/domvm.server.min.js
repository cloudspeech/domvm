// https://github.com/leeoniya/domvm (3.x-dev, server build)

!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.domvm=t()}(this,function(){"use strict";function n(){}function t(n){return null!=n}function e(n){return null!=n&&n.constructor===Object}function r(n,t,e,r){n.splice.apply(n,[e,r].concat(t))}function l(n){return"function"==typeof n}function i(n){for(var t=arguments,e=1;e<t.length;e++)for(var r in t[e])n[r]=t[e][r];return n}function o(n,t){for(var e=[],r=t;r<n.length;r++)e.push(n[r]);return e}function a(n,t){for(var e in n)if(n[e]!==t[e])return!1;return!0}function u(n,t){var e=n.length;if(t.length!==e)return!1;for(var r=0;r<e;r++)if(n[r]!==t[r])return!1;return!0}function f(n){function t(){e=0,n.apply(r,l)}if(!_n)return n;var e,r,l;return function(){r=this,l=arguments,e||(e=_n(t))}}function s(n){return"o"===n[0]&&"n"===n[1]}function d(n){return"_"===n[0]}function c(n){return"style"===n}function v(n){n&&n.el&&n.el.offsetHeight}function h(n){return null!=n.node&&null!=n.node.el}function y(n,t){switch(t){case"value":case"checked":case"selected":return!0}return!1}function p(n){for(n=n||wn;null==n.vm&&n.parent;)n=n.parent;return n.vm}function m(){}function b(n){var t=new m;return t.type=hn,t.body=n,t}function g(n,t){var e=Cn(n,function(n){e&&(null!=t.node&&t.redraw(),En(e))});return An(n)}function k(n,t){var e=Cn(n,function(n){e&&null!=t.node&&t.redraw()});return e}function _(n,e,r,l){var i=new m;i.type=vn,i.flags=l||0,i.attrs=e||null;var o=function(n){var t=Rn[n];if(null==t){var e,r,l,i;for(Rn[n]=t={tag:(e=n.match(/^[-\w]+/))?e[0]:"div",id:(r=n.match(/#([-\w]+)/))?r[1]:null,class:(l=n.match(/\.([-\w.]+)/))?l[1].replace(/\./g," "):null,attrs:null};i=On.exec(n);)null==t.attrs&&(t.attrs={}),t.attrs[i[1]]=i[2]||""}return t}(n);i.tag=o.tag;var a=t(o.id),u=t(o.class),f=t(o.attrs);if(a||u||f){var s=i.attrs||{};if(a&&!t(s.id)&&(s.id=o.id),u&&(i._class=o.class,s.class=o.class+(t(s.class)?" "+s.class:"")),f)for(var d in o.attrs)t(s[d])||(s[d]=o.attrs[d]);i.attrs=s}var c=i.attrs;return t(c)&&(t(c._key)&&(i.key=c._key),t(c._ref)&&(i.ref=c._ref),t(c._hooks)&&(i.hooks=c._hooks),t(c._data)&&(i.data=c._data),t(c._flags)&&(i.flags=c._flags),t(i.key)||(t(i.ref)?i.key=i.ref:t(c.id)?i.key=c.id:t(c.name)&&(i.key=c.name+("radio"===c.type||"checkbox"===c.type?c.value:"")))),null!=r&&(i.body=r),i}function w(n,t,e,l){if(n.type!==mn&&n.type!==pn){n.parent=t,n.idx=e,n.vm=l,null!=n.ref&&function(n,t,e){!function(n,t,e){for(var r;r=t.shift();)0===t.length?n[r]=e:n[r]=n=n[r]||{}}(n,["refs"].concat(t.split(".")),e)}(p(n),n.ref,n);var i=n.hooks,o=l&&l.hooks;(i&&(i.willRemove||i.didRemove)||o&&(o.willUnmount||o.didUnmount))&&function(n){for(;n=n.parent;)n.flags|=In}(n),xn(n.body)?function(n){for(var t=n.body,e=0;e<t.length;e++){var l=t[e];!1===l||null==l?t.splice(e--,1):xn(l)?r(t,l,e--,1):(null==l.type&&(t[e]=l=b(""+l)),l.type===hn?null==l.body||""===l.body?t.splice(e--,1):e>0&&t[e-1].type===hn?(t[e-1].body+=l.body,t.splice(e--,1)):w(l,n,e,null):w(l,n,e,null))}}(n):""===n.body?n.body=null:Sn(n.body)&&(n.body=g(n.body,p(n)))}}function x(n,t){return isNaN(t)||Vn[n]?t:t+"px"}function N(n,t){var e=(n.attrs||wn).style,r=t?(t.attrs||wn).style:null;if(null==e||function(n){var t=typeof n;return"string"===t||"number"===t}(e))n.el.style.cssText=e;else{for(var l in e){var i=e[l];Sn(i)&&(i=g(i,p(n))),(null==r||null!=i&&i!==r[l])&&(n.el.style[l]=x(l,i))}if(r)for(var o in r)null==e[o]&&(n.el.style[o]="")}}function S(n,t,e,r,l){if(null!=n){var i=e.hooks[t];if(i){if("d"!==t[0]||"i"!==t[1]||"d"!==t[2])return i(e,r);l?v(e.parent)&&i(e,r):jn.push([i,e,r])}}}function A(n){if(jn.length){v(n.node);for(var t;t=jn.shift();)t[0](t[1],t[2])}}function C(n){return n.nextSibling}function E(n){var t=n.vm,e=null!=t&&S(t.hooks,"willUnmount",t,t.data),r=S(n.hooks,"willRemove",n);if((n.flags&In)===In&&xn(n.body))for(var l=0;l<n.body.length;l++)E(n.body[l]);return e||r}function R(n,t,e){var r=t._node,l=r.vm;if(xn(r.body))if((r.flags&In)===In)for(var i=0;i<r.body.length;i++)R(t,r.body[i].el);else I(r);delete t._node,n.removeChild(t),S(r.hooks,"didRemove",r,null,e),null!=l&&(S(l.hooks,"didUnmount",l,l.data,e),l.node=null)}function O(n,t){var e=t._node;if(!e._dead){var r=E(e);null!=r&&function(n){return"object"==typeof n&&l(n.then)}(r)?(e._dead=!0,r.then(function(n,t,e){return function(){return n.apply(e,t)}}(R,[n,t,!0]))):R(n,t)}}function I(n){for(var t=n.body,e=0;e<t.length;e++){var r=t[e];delete r.el._node,null!=r.vm&&(r.vm.node=null),xn(r.body)&&I(r)}}function L(n){var t=n.el;if(0==(n.flags&In))xn(n.body)&&I(n),t.textContent=null;else{var e=t.firstChild;do{var r=C(e);O(t,e)}while(e=r)}}function M(n,t,e){var r=t._node,l=null!=t.parentNode,i=t!==e&&l?null:r.vm;null!=i&&S(i.hooks,"willMount",i,i.data),S(r.hooks,l?"willReinsert":"willInsert",r),n.insertBefore(t,e),S(r.hooks,l?"didReinsert":"didInsert",r),null!=i&&S(i.hooks,"didMount",i,i.data)}function T(n,t,e){M(n,t,e?C(e):null)}function V(n,t,e){n[t]=e}function j(n,t,e,r,l){var i=n.apply(l,t.concat([e,r,l,l.data]));l.onevent(e,r,l,l.data,t),zn.call(null,e,r,l,l.data,t),!1===i&&(e.preventDefault(),e.stopPropagation())}function D(n){var t,e,r=function(n){for(;null==n._node;)n=n.parentNode;return n._node}(n.target),l=p(r),i=n.currentTarget._node.attrs["on"+n.type];if(xn(i))j(t=i[0],e=i.slice(1),n,r,l);else for(var o in i)if(n.target.matches(o)){var a=i[o];xn(a)?(t=a[0],e=a.slice(1)):(t=a,e=[]),j(t,e,n,r,l)}}function z(n,t,e,r){if(e!==r){var i=n.el;null==e||l(e)?V(i,t,e):null==r&&V(i,t,D)}}function U(n,t,e){"."===t[0]&&(t=t.substr(1),e=!0),e?n.el[t]="":n.el.removeAttribute(t)}function F(n,t,e,r,l){var i=n.el;null!=n.ns?i.setAttribute(t,e):"class"===t?i.className=e:"id"===t||"boolean"==typeof e||r?i[t]=e:"."===t[0]?i[t.substr(1)]=e:i.setAttribute(t,e)}function H(n,t,e){var r=n.attrs||wn,l=t.attrs||wn;if(r===l);else{for(var i in r){var o=r[i];if(null!=o){var a=y(n.tag,i),u=a?n.el[i]:l[i];Sn(o)&&(r[i]=o=g(o,p(n))),o===u||(c(i)?N(n,t):d(i)||(s(i)?z(n,i,o,u):F(n,i,o,a)))}}for(var i in l)null==r[i]&&!d(i)&&U(n,i,y(n.tag,i)||s(i))}}function G(n,t,e,r){return n.type===pn&&(t=n.data,e=n.key,r=n.opts,n=n.view),new J(n,t,e,r)}function P(n){for(var t=0;t<n.body.length;t++){var e=n.body[t],r=e.type;if(r<=yn)M(n.el,W(e));else if(r===pn){r=(l=G(e.view,e.data,e.key,e.opts)._redraw(n,t,!1)).node.type,M(n.el,W(l.node))}else if(r===mn){var l;(l=e.vm)._redraw(n,t),r=l.node.type,M(n.el,l.node.el)}}}function W(n,t){return null==n.el&&(n.type===vn?(n.el=t||function(n,t){return null!=t?kn.createElementNS(t,n):kn.createElement(n)}(n.tag,n.ns),null!=n.attrs&&H(n,wn),(n.flags&Tn)===Tn&&n.body.body(n),xn(n.body)?P(n):null!=n.body&&(n.el.textContent=n.body)):n.type===hn?n.el=t||function(n){return kn.createTextNode(n)}(n.body):n.type===yn&&(n.el=t||function(n){return kn.createComment(n)}(n.body))),n.el._node=n,n.el}function Y(n,t,e,r,l,i,o,a){return function(u,f,s,d,c,v){var h,y;if(null!=d[r]){if(null==(h=d[r]._node))return void(d[r]=n(d[r]));if(function(n){return n.parent}(h)!==u)return y=n(d[r]),null!=h.vm?h.vm.unmount(!0):O(f,d[r]),void(d[r]=y)}if(d[l]==c)return Fn;if(null==d[l].el)e(f,W(d[l]),d[r]),d[l]=t(d[l],s);else if(d[l].el===d[r])d[l]=t(d[l],s),d[r]=n(d[r]);else{if(v||h!==d[o])return v&&null!=d[r]?function(n,t,e,r,l,i,o,a,u){if(a._lis)e(i,u[l].el,u[r]),u[l]=t(u[l],o);else{var f=function(n,t){var e,r=0,l=t.length-1;if(l<=2147483647)for(;r<=l;){if(e=r+l>>1,t[e]===n)return e;t[e]<n?r=e+1:l=e-1}else for(;r<=l;){if(e=Math.floor((r+l)/2),t[e]===n)return e;t[e]<n?r=e+1:l=e-1}return r==t.length?null:r}(a.idx,u.tombs);a._lis=!0;var s=n(u[r]);e(i,u[r],null!=f?o[u.tombs[f]].el:f),null==f?u.tombs.push(a.idx):u.tombs.splice(f,0,a.idx),u[r]=s}}(n,t,e,r,l,f,s,h,d):Un;y=d[r],d[r]=n(y),a(f,y,d[i]),d[i]=y}}}function q(n,t){var e=t.body,r=n.el,l=n.body,i={lftNode:l[0],rgtNode:l[l.length-1],lftSib:(e[0]||wn).el,rgtSib:(e[e.length-1]||wn).el};n:for(;;){for(;;){var o=Hn(n,r,l,i,null,!1);if(o===Un)break;if(o===Fn)break n}for(;;){var a=Gn(n,r,l,i,i.lftNode,!1);if(a===Un)break;if(a===Fn)break n}!function(n,t,e,r){for(var l=Array.prototype.slice.call(t.childNodes),i=[],o=0;o<l.length;o++){var a=l[o]._node;a.parent===n&&i.push(a.idx)}for(var u=function(n){var t=n.slice(),e=[];e.push(0);for(var r,l,i=0,o=n.length;i<o;++i){var a=e[e.length-1];if(n[a]<n[i])t[i]=a,e.push(i);else{for(r=0,l=e.length-1;r<l;){var u=(r+l)/2|0;n[e[u]]<n[i]?r=u+1:l=u}n[i]<n[e[r]]&&(r>0&&(t[i]=e[r-1]),e[r]=i)}}for(l=e[(r=e.length)-1];r-- >0;)e[r]=l,l=t[l];return e}(i).map(function(n){return i[n]}),f=0;f<u.length;f++)e[u[f]]._lis=!0;r.tombs=u;for(;;){var s=Hn(n,t,e,r,null,!0);if(s===Fn)break}}(n,r,l,i);break}}function B(n){return n.el._node.parent!==n.parent}function Z(n,t,e){return t[e]}function $(n,t,e){for(;e<t.length;e++){var r=t[e];if(null!=r.vm){if(n.type===pn&&r.vm.view===n.view&&r.vm.key===n.key||n.type===mn&&r.vm===n.vm)return r}else if(!B(r)&&n.tag===r.tag&&n.type===r.type&&n.key===r.key&&(n.flags&~In)==(r.flags&~In))return r}return null}function K(n,t,e){if(null==t._keys){if(t[e].key===n.key)return t[e];for(var r={},l=0;l<t.length;l++)r[t[l].key]=l;t._keys=r}return t[t._keys[n.key]]}function X(t,e){S(e.hooks,"willRecycle",e,t);var r=t.el=e.el,l=e.body,i=t.body;if(r._node=t,t.type!==hn||i===l){null==t.attrs&&null==e.attrs||H(t,e);var o=xn(l),a=xn(i),u=(t.flags&Tn)===Tn;o?a||u?function(t,e){var r=t.body,l=r.length,i=e.body,o=i.length,a=(t.flags&Tn)===Tn,u=(t.flags&Ln)===Ln,f=(t.flags&Mn)===Mn,s=!u&&t.type===vn,d=!0,c=0===o?n:f?K:u||a?Z:$;if(s&&0===l)return L(e),void(a&&(t.body=[]));var v,y,p=0,m=!1,b=0;if(a)var g={key:null},k=Array(l);for(var _=0;_<l;_++){if(a){var x=!1,N=null;d&&(f&&(g.key=r.key(_)),v=c(g,i,b)),null!=v?(y=v.idx,!0===(N=r.diff(_,v))?((S=v).parent=t,S.idx=_,S._lis=!1):x=!0):x=!0,x&&(w(S=r.tpl(_),t,_),S._diff=null!=N?N:r.diff(_),null!=v&&X(S,v)),k[_]=S}else{var S=r[_],A=S.type;if(A<=yn)(v=d&&c(S,i,b))&&(X(S,v),y=v.idx);else if(A===pn){if(v=d&&c(S,i,b)){y=v.idx;var C=v.vm._update(S.data,t,_)}else var C=G(S.view,S.data,S.key,S.opts)._redraw(t,_,!1);A=C.node.type}else if(A===mn){var E=h(S.vm),C=S.vm._update(S.data,t,_,E);A=C.node.type}}if(null!=v&&(y===b?++b===o&&l>o&&(v=null,d=!1):m=!0,!f&&o>100&&m&&++p%10==0))for(;b<o&&B(i[b]);)b++}a&&(t.body=k);s&&q(t,e)}(t,e):i!==l&&(null!=i?r.textContent=i:L(e)):a?(L(e),P(t)):i!==l&&(null!=i&&null!=l?r.firstChild.nodeValue=i:r.textContent=i),S(e.hooks,"didRecycle",e,t)}else r.nodeValue=i}function J(n,t,r,i){var o=this;o.view=n,o.data=t,o.key=r,Sn(t)&&(o._stream=k(t,o)),i&&(o.opts=i,o.config(i));var a=e(n)?n:n.call(o,o,t,r,i);l(a)?o.render=a:(o.render=a.render,o.config(a)),o._redrawAsync=f(function(n){return o.redraw(!0)}),o._updateAsync=f(function(n){return o.update(n,!0)}),o.init&&o.init.call(o,o,o.data,o.key,i)}function Q(n,t,e,r){return null!=e&&(e.body[r]=t,t.idx=r,t.parent=e,t._lis=!1),n}function nn(n,t,r,l){var i,o;return null==r?e(t)?i=t:o=t:(i=t,o=r),_(n,i,o,l)}function tn(n,t,e,r){this.view=n,this.data=t,this.key=e,this.opts=r}function en(n){this.vm=n}function rn(n,t){var e=n.body;if(xn(e))for(var r=0;r<e.length;r++){var l=e[r];null!=l.vm?t.push(l.vm):rn(l,t)}return t}function ln(n){var t,r,l=arguments,i=l.length;if(i>1){var a=1;e(l[1])&&(r=l[1],a=2),t=i!==a+1||l[a]instanceof m||l[a]instanceof tn||l[a]instanceof en?o(l,a):l[a]}return _(n,r,t)}function on(n){return n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function an(n){var t="";for(var e in n)null!=n[e]&&(t+=on(e)+": "+x(e,n[e])+"; ");return t}function un(n){return null==n?"":""+n}function fn(n){n=un(n);for(var t=0,e="";t<n.length;t++)switch(n[t]){case"&":e+="&amp;";break;case"<":e+="&lt;";break;case">":e+="&gt;";break;default:e+=n[t]}return e}function sn(n){n=un(n);for(var t=0,e="";t<n.length;t++)e+='"'===n[t]?"&quot;":n[t];return e}function dn(n,t){for(var e="",r=0;r<n.length;r++)e+=cn(n[r],t);return e}function cn(n,t){var e,r;switch(n.type){case pn:e=G(n.view,n.data,n.key,n.opts).html(t);break;case mn:e=n.vm.html();break;case vn:if(null!=n.el&&null==n.tag){e=n.el.outerHTML;break}var l="";l+="<"+n.tag;var i=n.attrs,o=null!=i;if(o){for(var a in i)if(!(s(a)||"."===a[0]||"_"===a[0]||!1===t&&y(n.tag,a))){var u=i[a];"style"!==a||null==u?!0===u?l+=" "+fn(a)+'=""':!1===u||null!=u&&(l+=" "+fn(a)+'="'+sn(u)+'"'):r="object"==typeof u?an(u):u}null!=r&&(l+=' style="'+sn(r.trim())+'"')}if(null==n.body&&null!=n.ns&&"svg"!==n.tag)return l+"/>";l+=">",qn[n.tag]||(o&&null!=i[Bn]?l+=i[Bn]:xn(n.body)?l+=dn(n.body,t):(n.flags&Tn)===Tn?(n.body.body(n),l+=dn(n.body,t)):l+=fn(n.body),l+="</"+n.tag+">"),e=l;break;case hn:e=fn(n.body);break;case yn:e="\x3c!--"+fn(n.body)+"--\x3e"}return e}var vn=1,hn=2,yn=3,pn=4,mn=5,bn="undefined"!=typeof window,gn=bn?window:{},kn=bn?document:{},_n=gn.requestAnimationFrame,wn={},xn=Array.isArray,Nn=m.prototype={constructor:m,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null},Sn=function(){return!1},An=n,Cn=n,En=n,Rn={},On=/\[(\w+)(?:=(\w+))?\]/g,In=1,Ln=2,Mn=4,Tn=8,Vn={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jn=[],Dn={},zn=n,Un=1,Fn=2,Hn=Y(C,function(n,t){return t[n.idx+1]},M,"lftSib","lftNode","rgtSib","rgtNode",T),Gn=Y(function(n){return n.previousSibling},function(n,t){return t[n.idx-1]},T,"rgtSib","rgtNode","lftSib","lftNode",M),Pn=J.prototype={constructor:J,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:n,refs:null,render:null,mount:function(n,t){return t?(L({el:n,flags:0}),this._redraw(null,null,!1),n.nodeName.toLowerCase()!==this.node.tag?(W(this.node),M(n.parentNode,this.node.el,n),n.parentNode.removeChild(n)):M(n.parentNode,W(this.node,n),n)):(this._redraw(null,null),n&&M(n,this.node.el)),n&&A(this),this},unmount:function(n){Sn(this._stream)&&En(this._stream);var t=this.node;O(t.el.parentNode,t.el),n||A(this)},config:function(n){n.init&&(this.init=n.init),n.diff&&(this.diff=n.diff),n.onevent&&(this.onevent=n.onevent),n.hooks&&(this.hooks=i(this.hooks||{},n.hooks)),n.onemit&&(this.onemit=i(this.onemit||{},n.onemit))},parent:function(){return p(this.node.parent)},root:function(){for(var n=this.node;n.parent;)n=n.parent;return n.vm},redraw:function(n){return n?this._redraw(null,null,h(this)):this._redrawAsync(),this},update:function(n,t){return t?this._update(n,null,null,h(this)):this._updateAsync(n),this},_update:function(n,t,e,r){return null!=n&&this.data!==n&&(S(this.hooks,"willUpdate",this,n),this.data=n,Sn(this._stream)&&En(this._stream),Sn(n)&&(this._stream=k(n,this))),this._redraw(t,e,r)},_redraw:function(n,t,e){var r,l,i=null==n,o=this.node&&this.node.el&&this.node.el.parentNode,f=this.node;if(null!=this.diff&&(r=this._diff,this._diff=l=this.diff(this,this.data),null!=f)){var s=xn(r)?u:a;if(r===l||s(r,l))return Q(this,f,n,t)}o&&S(this.hooks,"willRedraw",this,this.data);var d=this.render.call(this,this,this.data,r,l);if(d===f)return Q(this,f,n,t);if(this.refs=null,null!=this.key&&d.key!==this.key&&(d.key=this.key),this.node=d,n?(w(d,n,t,this),n.body[t]=d):f&&f.parent?(w(d,f.parent,f.idx,this),f.parent.body[f.idx]=d):w(d,null,null,this),!1!==e)if(f)if(f.tag!==d.tag||f.key!==d.key){f.vm=d.vm=null;var c=f.el.parentNode,v=C(f.el);O(c,f.el),M(c,W(d),v),f.el=d.el,d.vm=this}else X(d,f);else W(d);return o&&S(this.hooks,"didRedraw",this,this.data),i&&o&&A(this),this},_redrawAsync:null,_updateAsync:null},Wn="http://www.w3.org/2000/svg";tn.prototype={constructor:tn,type:pn,view:null,data:null,key:null,opts:null},en.prototype={constructor:en,type:mn,vm:null};var Yn={config:function(n){zn=n.onevent||zn,n.onemit&&function(n){i(Dn,n)}(n.onemit),n.stream&&function(n){Sn=n.is,An=n.val,Cn=n.sub,En=n.unsub}(n.stream)},ViewModel:J,VNode:m,createView:G,defineElement:nn,defineSvgElement:function(n,t,e,r){var l=nn(n,t,e,r);return l.ns=Wn,l},defineText:b,defineComment:function(n){var t=new m;return t.type=yn,t.body=n,t},defineView:function(n,t,e,r){return new tn(n,t,e,r)},injectView:function(n){return new en(n)},injectElement:function(n){var t=new m;return t.type=vn,t.el=t.key=n,t},lazyList:function(n,t){var e=n.length,r={items:n,length:e,key:function(e){return t.key(n[e],e)},diff:function(e,r){var l=t.diff(n[e],e);if(null==r)return l;var i=r._diff;return(l===i||xn(i)?u(l,i):a(l,i))||l},tpl:function(e){return t.tpl(n[e],e)},map:function(n){return t.tpl=n,r},body:function(n){for(var t=Array(e),l=0;l<e;l++){var i=r.tpl(l);i._diff=r.diff(l),t[l]=i,w(i,n,l)}n.body=t}};return r},FIXED_BODY:Ln,DEEP_REMOVE:In,KEYED_LIST:Mn,LAZY_LIST:Tn};Nn.patch=function(n,t){!function(n,t,e){if(null!=t.type){if(null!=n.vm)return;w(t,n.parent,n.idx,null),n.parent.body[n.idx]=t,X(t,n),e&&v(t),A(p(t))}else{var r=Object.create(n);r.attrs=i({},n.attrs);var l=i(n.attrs,t);if(null!=n._class){var o=l.class;l.class=null!=o&&""!==o?n._class+" "+o:n._class}H(n,r),e&&v(n)}}(this,n,t)},Pn.emit=function(n){var t=this,e=t,r=o(arguments,1).concat(e,e.data);do{var l=t.onemit,i=l?l[n]:null;if(i){i.apply(t,r);break}}while(t=t.parent());Dn[n]&&Dn[n].apply(t,r)},Pn.onemit=null,Pn.body=function(){return rn(this.node,[])},Yn.defineElementSpread=ln,Yn.defineSvgElementSpread=function(){var n=ln.apply(null,arguments);return n.ns=Wn,n},Pn._stream=null;var qn={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Bn=".innerHTML";return Pn.html=function(n){return null==this.node&&this._redraw(null,null,!1),cn(this.node,n)},Nn.html=function(n){return cn(this,n)},Yn});