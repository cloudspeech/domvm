// https://github.com/leeoniya/domvm (3.x-dev, full build)
!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):n.domvm=t()}(this,function(){"use strict";var n=1,t=2,e=3,r=4,l=5,i="undefined"!=typeof window,o=i?window:{},a=i?document:{},u=o.requestAnimationFrame,s={};function f(){}var d=Array.isArray;function c(n){return null!=n&&n.constructor===Object}function v(n){return"function"==typeof n}function h(n){for(var t=arguments,e=1;e<t.length;e++)for(var r in t[e])n[r]=t[e][r];return n}function y(n,t){for(var e=[],r=t;r<n.length;r++)e.push(n[r]);return e}function p(n,t){for(var e in n)if(n[e]!==t[e])return!1;return!0}function b(n,t){var e=n.length;if(t.length!==e)return!1;for(var r=0;r<e;r++)if(n[r]!==t[r])return!1;return!0}function m(n){if(!u)return n;var t,e,r;function l(){t=0,n.apply(e,r)}return function(){e=this,r=arguments,t||(t=u(l))}}function g(n){return"o"===n[0]&&"n"===n[1]}function k(n){return"_"===n[0]}function _(n){return"style"===n}function w(n){n&&n.el&&n.el.offsetHeight}function x(n){return null!=n.node&&null!=n.node.el}function N(n,t){switch(t){case"value":case"checked":case"selected":return!0}return!1}function S(n){for(n=n||s;null==n.vm&&n.parent;)n=n.parent;return n.vm}function A(){}var C=A.prototype={constructor:A,type:null,vm:null,key:null,ref:null,data:null,hooks:null,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,_diff:null,_dead:!1,_lis:!1,idx:null,parent:null};function E(n){var e=new A;return e.type=t,e.body=n,e}var R=function(){return!1},O=f,I=f,L=f;function M(n,t){var e=I(n,function(n){e&&(null!=t.node&&t.redraw(),L(e))});return O(n)}function T(n,t){var e=I(n,function(n){e&&null!=t.node&&t.redraw()});return e}var V={},j=/\[(\w+)(?:=(\w+))?\]/g;var D=1,z=2,U=4,F=8;function H(t,e,r,l){var i=new A;i.type=n,i.flags=l||0,i.attrs=e||null;var o=function(n){var t=V[n];if(null==t){var e,r,l,i;for(V[n]=t={tag:(e=n.match(/^[-\w]+/))?e[0]:"div",id:(r=n.match(/#([-\w]+)/))?r[1]:null,class:(l=n.match(/\.([-\w.]+)/))?l[1].replace(/\./g," "):null,attrs:null};i=j.exec(n);)null==t.attrs&&(t.attrs={}),t.attrs[i[1]]=i[2]||""}return t}(t);i.tag=o.tag;var a=null!=o.id,u=null!=o.class,s=null!=o.attrs;if(a||u||s){var f=i.attrs||{};if(a&&null==f.id&&(f.id=o.id),u&&(i._class=o.class,f.class=o.class+(null!=f.class?" "+f.class:"")),s)for(var d in o.attrs)null==f[d]&&(f[d]=o.attrs[d]);i.attrs=f}var c=i.attrs;return null!=c&&(null!=c._key&&(i.key=c._key),null!=c._ref&&(i.ref=c._ref),null!=c._hooks&&(i.hooks=c._hooks),null!=c._data&&(i.data=c._data),null!=c._flags&&(i.flags=c._flags),null==i.key&&(null!=i.ref?i.key=i.ref:null!=c.id?i.key=c.id:null!=c.name&&(i.key=c.name+("radio"===c.type||"checkbox"===c.type?c.value:"")))),null!=r&&(i.body=r),i}function G(n,e,i,o){if(n.type!==l&&n.type!==r){n.parent=e,n.idx=i,n.vm=o,null!=n.ref&&(a=S(n),u=n.ref,s=n,function(n,t,e){for(var r;r=t.shift();)0===t.length?n[r]=e:n[r]=n=n[r]||{}}(a,["refs"].concat(u.split(".")),s));var a,u,s,f=n.hooks,c=o&&o.hooks;(f&&(f.willRemove||f.didRemove)||c&&(c.willUnmount||c.didUnmount))&&function(n){for(;n=n.parent;)n.flags|=D}(n),d(n.body)?function(n){for(var e=n.body,r=0;r<e.length;r++){var l=e[r];!1===l||null==l?e.splice(r--,1):d(l)?(o=l,a=r--,u=1,(i=e).splice.apply(i,[a,u].concat(o))):(null==l.type&&(e[r]=l=E(""+l)),l.type===t?null==l.body||""===l.body?e.splice(r--,1):r>0&&e[r-1].type===t?(e[r-1].body+=l.body,e.splice(r--,1)):G(l,n,r,null):G(l,n,r,null))}var i,o,a,u}(n):""===n.body?n.body=null:R(n.body)&&(n.body=M(n.body,S(n)))}}var P={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,order:!0,lineClamp:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};function W(n,t){return isNaN(t)||P[n]?t:t+"px"}function Y(n,t){var e=(n.attrs||s).style,r=t?(t.attrs||s).style:null;if(null==e||function(n){var t=typeof n;return"string"===t||"number"===t}(e))n.el.style.cssText=e;else{for(var l in e){var i=e[l];R(i)&&(e[l]=i=M(i,S(n))),(null==r||null!=i&&i!==r[l])&&(n.el.style[l]=W(l,i))}if(r)for(var o in r)null==e[o]&&(n.el.style[o]="")}}var q=[];function B(n,t,e,r,l){if(null!=n){var i=e.hooks[t];if(i){if("d"!==t[0]||"i"!==t[1]||"d"!==t[2])return i(e,r);l?w(e.parent)&&i(e,r):q.push([i,e,r])}}}function Z(n){if(q.length){w(n.node);for(var t;t=q.shift();)t[0](t[1],t[2])}}function $(n){return n.nextSibling}function K(n,t,e){var r=t._node,l=r.vm;if(d(r.body))if((r.flags&D)===D)for(var i=0;i<r.body.length;i++)K(t,r.body[i].el);else J(r);delete t._node,n.removeChild(t),B(r.hooks,"didRemove",r,null,e),null!=l&&(B(l.hooks,"didUnmount",l,l.data,e),l.node=null)}function X(n,t){var e=t._node;if(!e._dead){var r=function n(t){var e=t.vm,r=null!=e&&B(e.hooks,"willUnmount",e,e.data),l=B(t.hooks,"willRemove",t);if((t.flags&D)===D&&d(t.body))for(var i=0;i<t.body.length;i++)n(t.body[i]);return r||l}(e);null!=r&&(a=r,"object"==typeof a&&v(a.then))?(e._dead=!0,r.then((l=K,i=[n,t,!0],o=void 0,function(){return l.apply(o,i)}))):K(n,t);var l,i,o,a}}function J(n){for(var t=n.body,e=0;e<t.length;e++){var r=t[e];delete r.el._node,null!=r.vm&&(r.vm.node=null),d(r.body)&&J(r)}}function Q(n){var t=n.el;if(0==(n.flags&D))d(n.body)&&J(n),t.textContent=null;else{var e=t.firstChild;do{var r=$(e);X(t,e)}while(e=r)}}function nn(n,t,e){var r=t._node,l=null!=t.parentNode,i=t!==e&&l?null:r.vm;null!=i&&B(i.hooks,"willMount",i,i.data),B(r.hooks,l?"willReinsert":"willInsert",r),n.insertBefore(t,e),B(r.hooks,l?"didReinsert":"didInsert",r),null!=i&&B(i.hooks,"didMount",i,i.data)}function tn(n,t,e){nn(n,t,e?$(e):null)}var en={};var rn=f,ln=!1;function on(n,t,e){n[t]=e}function an(n,t,e,r,l){var i=n.apply(l,t.concat([e,r,l,l.data]));l.onevent(e,r,l,l.data,t),rn.call(null,e,r,l,l.data,t),!1===i&&(e.preventDefault(),e.stopPropagation())}function un(n){var t,e,r=function(n){for(;null==n._node;)n=n.parentNode;return n._node}(n.target),l=S(r),i=n.currentTarget._node.attrs["on"+n.type];if(d(i))an(t=i[0],e=i.slice(1),n,r,l);else for(var o in i)if(n.target.matches(o)){var a=i[o];d(a)?(t=a[0],e=a.slice(1)):(t=a,e=[]),an(t,e,n,r,l)}}function sn(n,t,e,r){if(e!==r){var l=n.el;null==e||v(e)?on(l,t,e):null==r&&on(l,t,un)}}function fn(n,t,e,r,l){var i=n.el;null!=n.ns?i.setAttribute(t,e):"class"===t?i.className=e:"id"===t||"boolean"==typeof e||r?i[t]=e:"."===t[0]?i[t.substr(1)]=e:i.setAttribute(t,e)}function dn(n,t,e){var r=n.attrs||s,l=t.attrs||s;if(r===l);else{for(var i in r){var o=r[i];if(null!=o){var a=N(n.tag,i),u=a?n.el[i]:l[i];R(o)&&(r[i]=o=M(o,S(n))),o===u||(_(i)?Y(n,t):k(i)||(g(i)?sn(n,i,o,u):fn(n,i,o,a)))}}for(var i in l)null==r[i]&&!k(i)&&(f=n,d=i,c=N(n.tag,i)||g(i),"."===d[0]&&(d=d.substr(1),c=!0),c?f.el[d]="":f.el.removeAttribute(d))}var f,d,c}function cn(n,t,e,l){return n.type===r&&(t=n.data,e=n.key,l=n.opts,n=n.view),new An(n,t,e,l)}function vn(n){for(var t=0;t<n.body.length;t++){var i=n.body[t],o=i.type;if(o<=e)nn(n.el,hn(i));else if(o===r){o=(a=cn(i.view,i.data,i.key,i.opts)._redraw(n,t,!1)).node.type,nn(n.el,hn(a.node))}else if(o===l){var a;(a=i.vm)._redraw(n,t),o=a.node.type,nn(n.el,a.node.el)}}}function hn(r,l){null==r.el&&(r.type===n?(r.el=l||(u=r.tag,f=r.ns,null!=f?a.createElementNS(f,u):a.createElement(u)),null!=r.attrs&&dn(r,s),(r.flags&F)===F&&r.body.body(r),d(r.body)?vn(r):null!=r.body&&(r.el.textContent=r.body)):r.type===t?r.el=l||(o=r.body,a.createTextNode(o)):r.type===e&&(r.el=l||(i=r.body,a.createComment(i))));var i,o,u,f;return r.el._node=r,r.el}var yn=1,pn=2;function bn(n,t,e,r,l,i,o,a){return function(u,s,f,d,c,v){var h,y;if(null!=d[r]){if(null==(h=d[r]._node))return void(d[r]=n(d[r]));if(h.parent!==u)return y=n(d[r]),null!=h.vm?h.vm.unmount(!0):X(s,d[r]),void(d[r]=y)}if(d[l]==c)return pn;if(null==d[l].el)e(s,hn(d[l]),d[r]),d[l]=t(d[l],f);else if(d[l].el===d[r])d[l]=t(d[l],f),d[r]=n(d[r]);else{if(v||h!==d[o])return v&&null!=d[r]?function(n,t,e,r,l,i,o,a,u){if(a._lis)e(i,u[l].el,u[r]),u[l]=t(u[l],o);else{var s=function(n,t){var e,r=0,l=t.length-1;if(l<=2147483647)for(;r<=l;){if(t[e=r+l>>1]===n)return e;t[e]<n?r=e+1:l=e-1}else for(;r<=l;){if(t[e=Math.floor((r+l)/2)]===n)return e;t[e]<n?r=e+1:l=e-1}return r==t.length?null:r}(a.idx,u.tombs);a._lis=!0;var f=n(u[r]);e(i,u[r],null!=s?o[u.tombs[s]].el:s),null==s?u.tombs.push(a.idx):u.tombs.splice(s,0,a.idx),u[r]=f}}(n,t,e,r,l,s,f,h,d):yn;y=d[r],d[r]=n(y),a(s,y,d[i]),d[i]=y}}}var mn=bn($,function(n,t){return t[n.idx+1]},nn,"lftSib","lftNode","rgtSib","rgtNode",tn),gn=bn(function(n){return n.previousSibling},function(n,t){return t[n.idx-1]},tn,"rgtSib","rgtNode","lftSib","lftNode",nn);function kn(n,t,e,r){for(var l=Array.prototype.slice.call(t.childNodes),i=[],o=0;o<l.length;o++){var a=l[o]._node;a.parent===n&&i.push(a.idx)}for(var u=function(n){var t=n.slice(),e=[];e.push(0);for(var r,l,i=0,o=n.length;i<o;++i){var a=e[e.length-1];if(n[a]<n[i])t[i]=a,e.push(i);else{for(r=0,l=e.length-1;r<l;){var u=(r+l)/2|0;n[e[u]]<n[i]?r=u+1:l=u}n[i]<n[e[r]]&&(r>0&&(t[i]=e[r-1]),e[r]=i)}}for(l=e[(r=e.length)-1];r-- >0;)e[r]=l,l=t[l];return e}(i).map(function(n){return i[n]}),s=0;s<u.length;s++)e[u[s]]._lis=!0;for(r.tombs=u;;){if(mn(n,t,e,r,null,!0)===pn)break}}function _n(n){return n.el._node.parent!==n.parent}function wn(n,t,e){return t[e]}function xn(n,t,e){for(;e<t.length;e++){var i=t[e];if(null!=i.vm){if(n.type===r&&i.vm.view===n.view&&i.vm.key===n.key||n.type===l&&i.vm===n.vm)return i}else if(!_n(i)&&n.tag===i.tag&&n.type===i.type&&n.key===i.key&&(n.flags&~D)==(i.flags&~D))return i}return null}function Nn(n,t,e){if(null==t._keys){if(t[e].key===n.key)return t[e];for(var r={},l=0;l<t.length;l++)r[t[l].key]=l;t._keys=r}return t[t._keys[n.key]]}function Sn(i,o){B(o.hooks,"willRecycle",o,i);var a=i.el=o.el,u=o.body,c=i.body;if(a._node=i,i.type!==t||c===u){null==i.attrs&&null==o.attrs||dn(i,o);var v=d(u),h=d(c),y=(i.flags&F)===F;v?h||y?function(t,i){var o=t.body,a=o.length,u=i.body,d=u.length,c=(t.flags&F)===F,v=(t.flags&z)===z,h=(t.flags&U)===U,y=!v&&t.type===n,p=!0,b=0===d?f:h?Nn:v||c?wn:xn;if(y&&0===a)return Q(i),void(c&&(t.body=[]));var m,g,k=0,_=!1,w=0;if(c)var N={key:null},S=Array(a);for(var A=0;A<a;A++){if(c){var C=!1,E=null;p&&(h&&(N.key=o.key(A)),m=b(N,u,w)),null!=m?(g=m.idx,!0===(E=o.diff(A,m))?((R=m).parent=t,R.idx=A,R._lis=!1):C=!0):C=!0,C&&(G(R=o.tpl(A),t,A),R._diff=null!=E?E:o.diff(A),null!=m&&Sn(R,m)),S[A]=R}else{var R=o[A],O=R.type;if(O<=e)(m=p&&b(R,u,w))&&(Sn(R,m),g=m.idx);else if(O===r){if(m=p&&b(R,u,w)){g=m.idx;var I=m.vm._update(R.data,t,A)}else var I=cn(R.view,R.data,R.key,R.opts)._redraw(t,A,!1);O=I.node.type}else if(O===l){var L=x(R.vm),I=R.vm._update(R.data,t,A,L);O=I.node.type}}if(null!=m&&(g===w?++w===d&&a>d&&(m=null,p=!1):_=!0,!h&&d>100&&_&&++k%10==0))for(;w<d&&_n(u[w]);)w++}c&&(t.body=S);y&&function(n,t){var e=t.body,r=n.el,l=n.body,i={lftNode:l[0],rgtNode:l[l.length-1],lftSib:(e[0]||s).el,rgtSib:(e[e.length-1]||s).el};n:for(;;){for(;;){var o=mn(n,r,l,i,null,!1);if(o===yn)break;if(o===pn)break n}for(;;){var a=gn(n,r,l,i,i.lftNode,!1);if(a===yn)break;if(a===pn)break n}kn(n,r,l,i);break}}(t,i)}(i,o):c!==u&&(null!=c?a.textContent=c:Q(o)):h?(Q(o),vn(i)):c!==u&&(null!=c&&null!=u?a.firstChild.nodeValue=c:a.textContent=c),B(o.hooks,"didRecycle",o,i)}else a.nodeValue=c}function An(n,t,e,r){var l=this;l.view=n,l.data=t,l.key=e,R(t)&&(l._stream=T(t,l)),r&&(l.opts=r,l.config(r));var i=c(n)?n:n.call(l,l,t,e,r);v(i)?l.render=i:(l.render=i.render,l.config(i)),l._redrawAsync=m(function(n){return l.redraw(!0)}),l._updateAsync=m(function(n){return l.update(n,!0)}),l.init&&l.init.call(l,l,l.data,l.key,r)}var Cn=An.prototype={constructor:An,_diff:null,init:null,view:null,key:null,data:null,state:null,api:null,opts:null,node:null,hooks:null,onevent:f,refs:null,render:null,mount:function(n,t){t?(Q({el:n,flags:0}),this._redraw(null,null,!1),n.nodeName.toLowerCase()!==this.node.tag?(hn(this.node),nn(n.parentNode,this.node.el,n),n.parentNode.removeChild(n)):nn(n.parentNode,hn(this.node,n),n)):(this._redraw(null,null),n&&nn(n,this.node.el));n&&Z(this);return this},unmount:function(n){R(this._stream)&&L(this._stream);var t=this.node;X(t.el.parentNode,t.el),n||Z(this)},config:function(n){n.init&&(this.init=n.init),n.diff&&(this.diff=n.diff),n.onevent&&(this.onevent=n.onevent),n.hooks&&(this.hooks=h(this.hooks||{},n.hooks)),n.onemit&&(this.onemit=h(this.onemit||{},n.onemit))},parent:function(){return S(this.node.parent)},root:function(){for(var n=this.node;n.parent;)n=n.parent;return n.vm},redraw:function(n){null==n&&(n=ln);return n?this._redraw(null,null,x(this)):this._redrawAsync(),this},update:function(n,t){null==t&&(t=ln);return t?this._update(n,null,null,x(this)):this._updateAsync(n),this},_update:function(n,t,e,r){null!=n&&this.data!==n&&(B(this.hooks,"willUpdate",this,n),this.data=n,R(this._stream)&&L(this._stream),R(n)&&(this._stream=T(n,this)));return this._redraw(t,e,r)},_redraw:function(n,t,e){var r,l,i=null==n,o=this.node&&this.node.el&&this.node.el.parentNode,a=this.node;if(null!=this.diff&&(r=this._diff,this._diff=l=this.diff(this,this.data),null!=a)){var u=d(r)?b:p,s=r===l||u(r,l);if(s)return En(this,a,n,t)}o&&B(this.hooks,"willRedraw",this,this.data);var f=this.render.call(this,this,this.data,r,l);if(f===a)return En(this,a,n,t);this.refs=null,null!=this.key&&f.key!==this.key&&(f.key=this.key);this.node=f,n?(G(f,n,t,this),n.body[t]=f):a&&a.parent?(G(f,a.parent,a.idx,this),a.parent.body[a.idx]=f):G(f,null,null,this);if(!1!==e)if(a)if(a.tag!==f.tag||a.key!==f.key){a.vm=f.vm=null;var c=a.el.parentNode,v=$(a.el);X(c,a.el),nn(c,hn(f),v),a.el=f.el,f.vm=this}else Sn(f,a);else hn(f);o&&B(this.hooks,"didRedraw",this,this.data),i&&o&&Z(this);return this},_redrawAsync:null,_updateAsync:null};function En(n,t,e,r){return null!=e&&(e.body[r]=t,t.idx=r,t.parent=e,t._lis=!1),n}function Rn(n,t,e,r){var l,i;return null==e?c(t)?l=t:i=t:(l=t,i=e),H(n,l,i,r)}var On="http://www.w3.org/2000/svg";function In(n,t,e,r){this.view=n,this.data=t,this.key=e,this.opts=r}In.prototype={constructor:In,type:r,view:null,data:null,key:null,opts:null};function Ln(n){this.vm=n}Ln.prototype={constructor:Ln,type:l,vm:null};var Mn={config:function(n){rn=n.onevent||rn,null!=n.syncRedraw&&(ln=n.syncRedraw),n.onemit&&(t=n.onemit,h(en,t));var t;n.stream&&(e=n.stream,R=e.is,O=e.val,I=e.sub,L=e.unsub);var e},ViewModel:An,VNode:A,createView:cn,defineElement:Rn,defineSvgElement:function(n,t,e,r){var l=Rn(n,t,e,r);return l.ns=On,l},defineText:E,defineComment:function(n){var t=new A;return t.type=e,t.body=n,t},defineView:function(n,t,e,r){return new In(n,t,e,r)},injectView:function(n){return new Ln(n)},injectElement:function(t){var e=new A;return e.type=n,e.el=e.key=t,e},lazyList:function(n,t){var e=n.length,r={items:n,length:e,key:function(e){return t.key(n[e],e)},diff:function(e,r){var l=t.diff(n[e],e);if(null==r)return l;var i=r._diff;return(l===i||d(i)?b(l,i):p(l,i))||l},tpl:function(e){return t.tpl(n[e],e)},map:function(n){return t.tpl=n,r},body:function(n){for(var t=Array(e),l=0;l<e;l++){var i=r.tpl(l);i._diff=r.diff(l),t[l]=i,G(i,n,l)}n.body=t}};return r},FIXED_BODY:z,DEEP_REMOVE:D,KEYED_LIST:U,LAZY_LIST:F};C.patch=function(n,t){!function(n,t,e){if(null!=t.type){if(null!=n.vm)return;G(t,n.parent,n.idx,null),n.parent.body[n.idx]=t,Sn(t,n),e&&w(t),Z(S(t))}else{var r=Object.create(n);r.attrs=h({},n.attrs);var l=h(n.attrs,t);if(null!=n._class){var i=l.class;l.class=null!=i&&""!==i?n._class+" "+i:n._class}dn(n,r),e&&w(n)}}(this,n,t)};function Tn(n){var t,e,r=arguments,l=r.length;if(l>1){var i=1;c(r[1])&&(e=r[1],i=2),t=l!==i+1||r[i]instanceof A||r[i]instanceof In||r[i]instanceof Ln?y(r,i):r[i]}return H(n,e,t)}Cn.emit=function(n){var t=this,e=t,r=y(arguments,1).concat(e,e.data);do{var l=t.onemit,i=l?l[n]:null;if(i){i.apply(t,r);break}}while(t=t.parent());en[n]&&en[n].apply(t,r)},Cn.onemit=null,Cn.body=function(){return function n(t,e){var r=t.body;if(d(r))for(var l=0;l<r.length;l++){var i=r[l];null!=i.vm?e.push(i.vm):n(i,e)}return e}(this.node,[])},Mn.defineElementSpread=Tn,Mn.defineSvgElementSpread=function(){var n=Tn.apply(null,arguments);return n.ns=On,n},Cn._stream=null;function Vn(n){var t="";for(var e in n)null!=n[e]&&(t+=(r=e,r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+W(e,n[e])+"; "));var r;return t}function jn(n){return null==n?"":""+n}var Dn={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};function zn(n){n=jn(n);for(var t=0,e="";t<n.length;t++)switch(n[t]){case"&":e+="&amp;";break;case"<":e+="&lt;";break;case">":e+="&gt;";break;default:e+=n[t]}return e}function Un(n){n=jn(n);for(var t=0,e="";t<n.length;t++)e+='"'===n[t]?"&quot;":n[t];return e}function Fn(n,t){for(var e="",r=0;r<n.length;r++)e+=Gn(n[r],t);return e}var Hn=".innerHTML";function Gn(i,o){var a,u;switch(i.type){case r:a=cn(i.view,i.data,i.key,i.opts).html(o);break;case l:a=i.vm.html();break;case n:if(null!=i.el&&null==i.tag){a=i.el.outerHTML;break}var s="";s+="<"+i.tag;var f=i.attrs,c=null!=f;if(c){for(var v in f)if(!(g(v)||"."===v[0]||"_"===v[0]||!1===o&&N(i.tag,v))){var h=f[v];"style"!==v||null==h?!0===h?s+=" "+zn(v)+'=""':!1===h||null!=h&&(s+=" "+zn(v)+'="'+Un(h)+'"'):u="object"==typeof h?Vn(h):h}null!=u&&(s+=' style="'+Un(u.trim())+'"')}if(null==i.body&&null!=i.ns&&"svg"!==i.tag)return s+"/>";s+=">",Dn[i.tag]||(c&&null!=f[Hn]?s+=f[Hn]:d(i.body)?s+=Fn(i.body,o):(i.flags&F)===F?(i.body.body(i),s+=Fn(i.body,o)):s+=zn(i.body),s+="</"+i.tag+">"),a=s;break;case t:a=zn(i.body);break;case e:a="\x3c!--"+zn(i.body)+"--\x3e"}return a}return Cn.attach=function(n){return null==this.node&&this._redraw(null,null,!1),function n(t,e){t.el=e,e._node=t;var i=t.attrs;for(var o in i){var a=i[o],u=N(t.tag,o);_(o)||k(o)||(g(o)?sn(t,o,a):null!=a&&u&&fn(t,o,a,u))}if((t.flags&F)===F&&t.body.body(t),d(t.body)&&t.body.length>0){var s=e.firstChild,f=0,c=t.body[f];do{c.type===r?c=cn(c.view,c.data,c.key,c.opts)._redraw(t,f,!1).node:c.type===l&&(c=c.node||c._redraw(t,f,!1).node),n(c,s)}while((s=s.nextSibling)&&(c=t.body[++f]))}}(this.node,n),this},Cn.html=function(n){return null==this.node&&this._redraw(null,null,!1),Gn(this.node,n)},C.html=function(n){return Gn(this,n)},Mn});