// @preserve https://github.com/leeoniya/domvm (2.x-dev, pico)
!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.domvm=e()}(this,function(){"use strict";function n(){}function e(n){return null!=n}function t(n){return null!=n&&n.constructor===Object}function r(n,e,t,r){n.splice.apply(n,[t,r].concat(e))}function o(n){var e=typeof n;return"string"===e||"number"===e}function l(n){return"function"==typeof n}function i(n){return"object"==typeof n&&l(n.then)}function u(n){for(var e=arguments,t=1;t<e.length;t++)for(var r in e[t])n[r]=e[t][r];return n}function f(n,e,t){for(var r;r=e.shift();)0===e.length?n[r]=t:n[r]=n=n[r]||{}}function a(n,e){var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}function d(n){function e(){t=0,n.apply(r,o)}if(!Hn)return n;var t,r,o;return function(){r=this,o=arguments,t||(t=Hn(e))}}function s(n,e,t){return function(){return n.apply(t,e)}}function c(n,e){var t,r=0,o=n.length-1;if(o<=2147483647)for(;r<=o;){if(t=r+o>>1,n[t].key===e)return t;n[t].key<e?r=t+1:o=t-1}else for(;r<=o;){if(t=Math.floor((r+o)/2),n[t].key===e)return t;n[t].key<e?r=t+1:o=t-1}return-1}function y(n){return"o"===n[0]&&"n"===n[1]}function v(n){return"_"===n[0]}function p(n){return"style"===n}function h(n){n&&n.el&&n.el.offsetHeight}function k(n,e){switch(e){case"value":case"checked":case"selected":return!0}return!1}function m(n){for(n=n||Un;null==n.vm&&n.parent;)n=n.parent;return n.vm}function w(){return!1}function b(n,e){return e}function _(n){return Fn.tag=n,Fn}function g(n,e){var t=(n.attrs||Un).style,r=e?(e.attrs||Un).style:null;if(null==t||o(t))n.el.style.cssText=t;else{for(var l in t){var i=t[l];w(i)&&(i=Bn(i,m(n))),(null==r||null!=i&&i!==r[l])&&(n.el.style[l]=b(l,i))}if(r)for(var u in r)null==t[u]&&(n.el.style[u]="")}}function x(n,e,t,r,o){if(!n)return e(t,r);o?h(t.parent)&&e(t,r):Pn.push([e,t,r])}function C(n,e,t,r){var o=e.hooks[n];if(o){var l="d"===n[0]&&"i"===n[1]&&"d"===n[2];return On(o)?o.map(function(n){return x(l,n,e,t)}):x(l,o,e,t,r)}}function N(){}function A(n,t,r,o){var l=new N;l.type=Vn,e(o)&&(l.flags=o),l.attrs=t;var i=_(n);if(l.tag=i.tag,i.id||i.class||i.attrs){var u=l.attrs||{};if(i.id&&!e(u.id)&&(u.id=i.id),i.class&&(l._class=i.class,u.class=i.class+(e(u.class)?" "+u.class:"")),i.attrs)for(var f in i.attrs)e(u[f])||(u[f]=i.attrs[f]);l.attrs=u}var a=l.attrs;return e(a)&&(e(a._key)&&(l.key=a._key),e(a._ref)&&(l.ref=a._ref),e(a._hooks)&&(l.hooks=a._hooks),e(a._raw)&&(l.raw=a._raw),e(a._data)&&(l.data=a._data),e(a._flags)&&(l.flags=a._flags),e(l.key)||(e(l.ref)?l.key=l.ref:e(a.id)?l.key=a.id:e(a.name)&&(l.key=a.name))),null!=r&&(l.body=r),l}function E(n){for(;null==n._node;)n=n.parentNode;return n._node}function S(n,e){return null!=e?Xn.createElementNS(e,n):Xn.createElement(n)}function R(n){return Xn.createTextNode(n)}function M(n){return Xn.createComment(n)}function V(n){return n.nextSibling}function T(n){return n.previousSibling}function I(n){var e=n.hooks,t=n.vm;t&&t.hooks&&C("willUnmount",t);var r=e&&C("willRemove",n);if((n.flags&qn)===qn&&On(n.body))for(var o=0;o<n.body.length;o++)I(n.body[o]);return r}function j(n,e,t){var r=e._node,o=r.hooks,l=r.vm;if((r.flags&qn)===qn&&On(r.body))for(var i=0;i<r.body.length;i++)j(e,r.body[i].el);n.removeChild(e),o&&C("didRemove",r,null,t),l&&l.hooks&&C("didUnmount",l,null,t)}function D(n,e){var t=e._node,r=(t.hooks,I(t));null!=r&&i(r)?r.then(s(j,[n,e,!0])):j(n,e)}function L(n){var e=n.el;if(0==(n.flags&qn))e.textContent=null;else for(;e.firstChild;)D(e,e.firstChild)}function H(n,e,t){var r=e._node,o=r.hooks,l=null!=e.parentNode,i=(e===t||!l)&&r.vm;i&&i.hooks&&C("willMount",i),o&&C(l?"willReinsert":"willInsert",r),n.insertBefore(e,t),o&&C(l?"didReinsert":"didInsert",r),i&&i.hooks&&C("didMount",i)}function U(n,e,t){H(n,e,t?V(t):null)}function O(n){u(zn,n)}function B(n,e,t){n[e]=t}function F(n,e,t){var r=E(n.target),o=m(r),l=e.apply(null,t.concat(n,r,o));zn.onevent.apply(null,[n,r,o].concat(t)),!1===l&&(n.preventDefault(),n.stopPropagation())}function P(n,e){return function(t){F(t,n,e)}}function Y(n){return function(e){for(var t in n)if(e.target.matches(t)){var r=n[t],o=On(r);F(e,o?r[0]:r,o?r.slice(1):[])}}}function q(n,e,t,r){if(t!==r){var o=n.el;On(t)?(null==r||!a(t,r))&&B(o,e,P(t[0],t.slice(1))):l(t)&&t!==r?B(o,e,P(t,[])):B(o,e,Y(t))}}function K(n,e,t){t?n.el[e]="":n.el.removeAttribute(e)}function X(n,e,t,r){var o=n.el;null==t?K(n,e):null!=n.ns?o.setAttribute(e,t):"class"===e?o.className=t:"id"===e||"boolean"==typeof t||r?o[e]=t:"."===e[0]?o[e.substr(1)]=t:o.setAttribute(e,t)}function z(n,e){var t=n.attrs||Un,r=e.attrs||Un;if(t===r);else{for(var o in t){var l=t[o],i=k(n.tag,o),u=i?n.el[o]:r[o];w(l)&&(t[o]=l=Bn(l,m(n))),l===u||(p(o)?g(n,e):v(o)||(y(o)?q(n,o,l,u):X(n,o,l,i)))}for(var o in r)!(o in t)&&!v(o)&&K(n,o,k(n.tag,o)||y(o))}}function G(n,e,t,r){if(n.type===jn)e=n.model,t=n.key,r=n.opts,n=n.view;else if(n.prototype._isClass)return new n(e,t,r);return new kn(n,e,t,r)}function J(n){var e=n.attrs;for(var t in e){var r=e[t],o=k(n.tag,t);w(r)&&(e[t]=r=Bn(r,m(n))),p(t)?g(n):v(t)||(y(t)?q(n,t,r):null!=r&&X(n,t,r,o))}}function Q(n){for(var e=0;e<n.body.length;e++){var t=n.body[e],r=t.type;if(r<=In)H(n.el,W(t));else if(r===jn)r=(o=G(t.view,t.model,t.key,t.opts)._redraw(n,e,!1)).node.type,H(n.el,W(o.node));else if(r===Dn){var o=t.vm;o._redraw(n,e),r=o.node.type,H(n.el,o.node.el)}}}function W(n,e){return null==n.el&&(n.type===Vn?(n.el=e||S(n.tag,n.ns),null!=n.attrs&&J(n),On(n.body)?Q(n):null!=n.body&&""!==n.body&&(n.raw?n.el.innerHTML=n.body:n.el.textContent=n.body)):n.type===Tn?n.el=e||R(n.body):n.type===In&&(n.el=e||M(n.body))),n.el._node=n,n.el}function Z(n,e){return e[n.idx+1]}function $(n,e){return e[n.idx-1]}function nn(n){return n.parent}function en(n,e,t,r){var o=T(t),l=V(r);return n(o,l),{lftSib:o?V(o):e.firstChild,rgtSib:l?T(l):e.lastChild}}function tn(n,e,t,r,o){var l=o.idx===t.idx+1,i=!l&&e._node===o,u=!!l||r._node===t;return i||u?en(function(t,o){u&&H(n,r,e),i&&H(n,e,o)},n,e,r):null}function rn(n,e,t,r){return en(function(t,o){for(var l,i=e;i!==o;i=V(i)){e=l=i;for(var u=V(i);u!==o;u=V(u))r(l,u)>0&&(l=u);l!==i&&(H(n,l,e),i=l)}},n,e,t)}function on(n,e){return n._node.idx-e._node.idx}function ln(n,e){var t,r,o,l,i=n.el,u=n.body,f=e.body,a=u[0],d=u[u.length-1],s=(f[0]||Un).el,c=(f[f.length-1]||Un).el;n:for(;;){for(;;){if(s){if(null==(o=s._node)){s=V(s);continue}if(nn(o)!==n){r=V(s),null!=o.vm?o.vm.unmount(!0):D(i,s),s=r;continue}}if(null==a)break n;if(null==a.el)H(i,W(a),s),a=Z(a,u);else{if(a.el!==s)break;a=Z(a,u),s=V(s)}}for(;;){if(c){if(null==(l=c._node)){c=T(c);continue}if(nn(l)!==n){r=T(c),null!=l.vm?l.vm.unmount(!0):D(i,c),c=r;continue}}if(d===a)break n;if(null==d.el)U(i,W(d),c),d=$(d,u);else{if(d.el!==c)break;d=$(d,u),c=T(c)}}(t=tn(i,s,a,c,d))?(s=t.lftSib,c=t.rgtSib):(s=(t=rn(i,s,c,on)).lftSib,c=t.rgtSib)}}function un(n,e,t,r){for(;t<e.length;t++){var o=e[t];if(n.type===jn&&null!=o.vm){var l=o.vm;if(l.view===n.view&&l.key===n.key)return o}if(o.el._node===o&&n.tag===o.tag&&n.type===o.type&&n.vm===o.vm){if(n.key===o.key)return o;if(null==o.key)return o}}return null}function fn(n,e){var t=c(e,n.key);return t>-1?e[t]:null}function an(n,e,t){e.hooks&&C("willRecycle",e,n);var r=n.el=e.el,o=e.body,l=n.body;if(r._node=n,n.type!==Tn||l===o){null==n.attrs&&null==e.attrs||z(n,e);var i=On(o),u=On(l);i?u?sn(n,e,t):l!==o&&(null!=l?n.raw?r.innerHTML=l:r.textContent=l:L(e)):u?(L(e),Q(n)):l!==o&&(n.raw?r.innerHTML=l:e.raw?r.textContent=l:r.firstChild?r.firstChild.nodeValue=l:r.textContent=l),e.hooks&&C("didRecycle",e,n)}else r.nodeValue=l}function dn(n,e){return n.key>e.key?1:n.key<e.key?-1:0}function sn(n,e,t){var r=n.body,o=r.length,l=e.type===Vn&&0==(e.flags&Yn);if(l&&0===o)L(e);else{var i=(e.flags&Kn)===Kn;if(i){(u=e.body.slice()).sort(dn);f=fn}else var u=e.body,f=un;for(var a,d=0,s=0;s<o;s++){var c=r[s],y=c.type;if(y<=In)(a=f(c,u,d))&&an(c,a);else if(y===jn){if(a=f(c,u,d))v=a.vm._update(c.model,n,s);else var v=G(c.view,c.model,c.key,c.opts)._redraw(n,s,!1);y=v.node.type}else y===Dn&&(y=(v=c.vm._update(c.model,n,s)).node.type);i||null==a||a.idx!==d||d++}l&&ln(n,e)}}function cn(n){var e=new N;return e.type=Tn,e.body=n,e}function yn(n,e,t){f(n,["refs"].concat(e.split(".")),t)}function vn(n){for(;n=n.parent;)n.flags|=qn}function pn(n,e,t,r){n.type!==Dn&&n.type!==jn&&(n.parent=e,n.idx=t,n.vm=r,null!=n.ref&&yn(m(n),n.ref,n),(n.hooks&&n.hooks.willRemove||r&&r.hooks&&r.hooks.willUnmount)&&vn(n),On(n.body)?hn(n):w(n.body)&&(n.body=Bn(n.body,m(n))))}function hn(n){for(var e=n.body,t=0;t<e.length;t++){var o=e[t];!1===o||null==o?e.splice(t--,1):On(o)?r(e,o,t--,1):(null==o.type&&(e[t]=o=cn(""+o)),o.type===Tn?null==o.body||""===o.body?e.splice(t--,1):t>0&&e[t-1].type===Tn?(e[t-1].body+=o.body,e.splice(t--,1)):pn(o,n,t,null):pn(o,n,t,null))}}function kn(n,e,t,r){var o=this;if(o.view=n,o.model=e,o.key=null==t?e:t,n.prototype._isClass){var i=o.diff;null!=i&&i!==Gn.diff&&(o.diff=Gn.diff.bind(o),o.diff(i))}else{var f=n.call(o,o,e,t,r);l(f)?o.render=f:(f.diff&&(o.diff(f.diff),delete f.diff),u(o,f))}r&&(o.opts=r,r.hooks&&o.hook(r.hooks),r.diff&&o.diff(r.diff)),o._redrawAsync=d(function(n){return o._redraw()}),o._updateAsync=d(function(n){return o._update(n)});var a=o.hooks;a&&a.didInit&&a.didInit.call(o,o,e,t,r)}function mn(n){if(Pn.length){h(n.node);for(var e;e=Pn.shift();)e[0](e[1],e[2])}}function wn(n,e){var t=this;return e?(L({el:n,flags:0}),t._redraw(null,null,!1),n.nodeName.toLowerCase()!==t.node.tag?(W(t.node),H(n.parentNode,t.node.el,n),n.parentNode.removeChild(n)):H(n.parentNode,W(t.node,n),n)):(t._redraw(null,null),n&&H(n,t.node.el)),n&&mn(t),t}function bn(n){var e=this,t=e.node;D(t.el.parentNode,t.el),n||mn(e)}function _n(n,e,t){var r=null==n,o=this,l=o.node&&o.node.el&&o.node.el.parentNode,i=o.node;if(l&&null!=o._diff&&o._diff())return i&&n&&(n.body[e]=i,i.idx=e,i.parent=n),o;l&&o.hooks&&C("willRedraw",o),o.refs=null;var u=o.render.call(o,o,o.model,o.key);if(!1!==o.key&&null!=o.key&&u.key!==o.key&&(u.key=o.key),o.node=u,n?(pn(u,n,e,o),n.body[e]=u):i&&i.parent?(pn(u,i.parent,i.idx,o),i.parent.body[i.idx]=u):pn(u,null,null,o),!1!==t)if(i)if(i.tag!==u.tag){i.vm=u.vm=null;var f=i.el.parentNode,a=V(i.el);D(f,i.el),H(f,W(u),a),i.el=u.el,u.vm=o}else an(u,i,r);else W(u);return l&&o.hooks&&C("didRedraw",o),r&&l&&mn(o),o}function gn(n,e,t,r){var o=this;return null!=n&&o.model!==n&&(o.hooks&&C("willUpdate",o,n),o.model=n),o._redraw(e,t,r)}function xn(n,e,r,o){var l,i;return null==r?t(e)?l=e:i=e:(l=e,i=r),A(n,l,i,o)}function Cn(n,e,t,r){var o=xn(n,e,t,r);return o.ns=Jn,o}function Nn(n){var e=new N;return e.type=In,e.body=n,e}function An(n,e,t,r){this.view=n,this.model=e,this.key=null==t?e:t,this.opts=r}function En(n,e,t,r){return new An(n,e,t,r)}function Sn(n){this.vm=n}function Rn(n){return new Sn(n)}function Mn(n){var e=new N;return e.type=Vn,e.el=e.key=n,e}var Vn=1,Tn=2,In=3,jn=4,Dn=5,Ln="undefined"!=typeof window,Hn=(Ln?window:{}).requestAnimationFrame,Un={},On=Array.isArray,Bn=n,Fn={},Pn=[],Yn=(N.prototype={constructor:N,type:null,vm:null,key:null,ref:null,data:null,hooks:null,raw:!1,ns:null,el:null,tag:null,attrs:null,body:null,flags:0,_class:null,idx:null,parent:null},1),qn=2,Kn=4,Xn=Ln?document:null,zn={onevent:n},Gn=kn.prototype={constructor:kn,_isClass:!1,view:null,key:null,model:null,opts:null,node:null,hooks:null,render:null,parent:function(){return m(this.node.parent)},root:function(){for(var n=this.node;n.parent;)n=n.parent;return n.vm},api:null,refs:null,mount:wn,unmount:bn,redraw:function(n){var e=this;return n?e._redraw():e._redrawAsync(),e},update:function(n,e){var t=this;return e?t._update(n):t._updateAsync(n),t},_update:gn,_redraw:_n,_redrawAsync:null,_updateAsync:null,hook:function(n){this.hooks=this.hooks||u({},this.hooks,n)}},Jn="http://www.w3.org/2000/svg";return An.prototype={constructor:An,type:jn,view:null,model:null,key:null,opts:null},Sn.prototype={constructor:Sn,type:Dn,vm:null},{config:O,ViewModel:kn,VNode:N,createView:G,defineElement:xn,defineSvgElement:Cn,defineText:cn,defineComment:Nn,defineView:En,injectView:Rn,injectElement:Mn,FIXED_BODY:Yn,DEEP_REMOVE:qn,KEYED_LIST:Kn}});
//# sourceMappingURL=domvm.pico.min.js.map
