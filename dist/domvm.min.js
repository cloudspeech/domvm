// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(l){module.exports=l()}||"function"===typeof define&&function(l){define("domvm",l)}||function(l){window.domvm=l()})(function(){function l(a,b,d,e,c,h,f){function g(a,b,c){h=a;f=b;return m(c,!1)}function m(a,c){u(k.events.willRedraw);k.imp=null!=a?a:e;k.refs={};k.keyMap={};var g=k.node,r=k.render.call(b,k.imp),r=v(r,h,f,k);r.key=p(d)?d:r.key;r.vm=k;k.node=r;var m=g;if(g&&(r.type!==g.type||r.tag!==g.tag))var m=null,n=!0;w(r,m);h&&
(h.body[f]=r);!1!==c&&(g&&y(g),!g&&l||A(r),n&&(g.el.parentNode.replaceChild(r.el,g.el),g.el=null));setTimeout(function(){var a=k,b;for(b in a.refs)a.refs[b]=a.refs[b].el;u(k.events.didRedraw)},0);return k}function B(a){var b=null,c=a.split(":");2==c.length&&(a=c[0],b=+c[1]);var c=Array.prototype.slice.call(arguments,1),d=k.node;if(null!==b){for(;b&&d.parent;)d=d.parent,d.vm&&b--;(b=(b=d.vm?d.vm.events:null)?b[a]:null)&&b.apply(null,c)}else for(;d&&(!d.vm||!(b=(b=d.vm.events)?b[a]:null)||!1!==b.apply(null,
c));)d=d.parent}var l=!h;n(a)&&(b=a[1],d=a[2],e=a[3],a=a[0]);!1===d&&(e=b,d=b=null);var k={exp:{},imp:e||{},node:null,view:[a,b,d],render:null,on:function(a,b){if(b)k.events[a].push(b);else for(var c in a)k.events[c].push(a[c])},events:{willRedraw:[],didRedraw:[],willDestroy:[],didDestroy:[]},redraw:C.useRaf?L(m):m,emit:B,refs:{},html:function(){return F(k.node)},keyMap:{},patch:function(){for(var a=arguments,b=0;b<a.length;b++){var c=a[b][1]._key,d=k.keyMap[c],e=d.parent,f=w(v(a[b],e,d.idx,k),d);
e.body[d.idx]=e.keyMap[c]=k.keyMap[c]=f}},mount:function(a){A(k.node);a.insertBefore(k.node.el,null);return k},attach:function(a){G(k.node,a);return k},destroy:function(a){u(k.events.willDestroy);if(h)if(a){for(a=f+1;a<h.body.length;a++){var b=h.body[a];b.idx=a-1;b.vm&&b.vm.updIdx(b.idx)}h.body.splice(f,1)}else h.body[f]=null;y(k.node,!0);k.node.vm=null;u(k.events.didDestroy)},moveTo:g,updIdx:function(a){f=a}};k.events._redraw=k.redraw;k.render=a.call(k.exp,k,b,d);B.redraw=function(a){a=p(a)?a:1E3;
B("_redraw:"+a)};return h?g(h,f,e):m(e)}function G(a,b){a.el=b;if(n(a.body))for(var d=0;d<a.body.length;d++)G(a.body[d],b.childNodes[d])}function y(a,b){n(a.body)&&(a.body.forEach(function(a,b){a&&(a.vm&&!a.moved?a.vm.destroy():a.el&&a.el.parentNode?a.el.parentNode.removeChild(a.el):y(a))}),a.body=null);a.vm=null;b&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function v(a,b,d,e){var c=a;a={type:null,key:null,ref:null,idx:null,parent:null,moved:!1,tag:null,ns:null,guard:!1,raw:!1,props:null,
el:null,keyMap:null,body:null};q(c)&&(c=c());if(n(c)&&c.length){a.type=1;if(1<c.length){var h=1;t(c[1])&&(a.props=c[1],h=2);a.body=c.length==h+1?p(c[h])?c[h]:q(c[h])?c[h]():c.slice(h):c.slice(h)}c=c[0];if(/[.#]/.test(c)){if(c=M(c),a.tag=c.tag,c.id||c["class"])a.props=a.props||{},a.props.id=c.id,a.props["class"]=c["class"]}else a.tag=c;if(a.props){var c=a.props,f;for(f in c)x(f)?c[f]=N(c[f],e.view[1]||null):q(c[f])&&("href"==f?(c.onclick=c[f],c.href=c[f].url):c[f]=c[f]());if(t(c.style))for(var g in c.style)f=
c.style[g],q(f)&&(c.style[g]=f());a.key=p(c._key)?c._key:p(c._ref)?c._ref:p(c.id)?c.id:p(c.name)?c.name:null;c._ref&&(a.ref=c._ref);c._raw&&(a.raw=!0);c._guard&&(a.guard=!0);c._ref=c._key=c._raw=c._guard=null}}else p(c)&&(a.type=2,a.body=c);null!==a.ref&&(e.refs[a.ref]=a);a.parent=b;a.idx=d;a.ns=b&&b.ns?b.ns:"svg"===a.tag||"math"===a.tag?a.tag:null;if(n(a.body)){b={};d=!1;g=0;for(c=a.body.length;g<c;g++){f=a.body[g];var m=h=null,l=!1,z=!1;q(f)&&(f=f());if(null==f)l=!0;else{var k=n(f),u=k?!1:t(f);
if(k)f.length?n(f[0])?z=!0:q(f[0])?h=f[2]:(m=v(f,a,g,e),h=m.key):l=!0;else if(u)if(q(f.redraw))f.moveTo(a,g),m=f.node,h=f.view[2];else{a.body[g--]=""+f;continue}else""===f?l=!0:0<g&&2===a.body[g-1].type?(a.body[g-1].body+=""+f,l=!0):m=v(""+f,a,g,e)}l||z?(z?(c=a.body,c.splice.apply(c,[g,1].concat(f))):a.body.splice(g,1),c=a.body.length,g--):(p(h)&&(b[h]=g,e.keyMap[h]=m,d=!0),a.body[g]=m||f)}d&&(a.keyMap=b)}return a}function w(a,b){b&&O(b,a);n(a.body)&&a.body.forEach(function(d,e){var c=n(d);if(b){var h=
P(d,a,b);if(null!==h){var f=h[1],h=b.body[h[0]];c&&h.vm?2===f?h.vm.moveTo(a,e,d[3]):1===f&&l.call(null,d[0],d[1],d[2],d[3],d[4],a,e):a.body[e]=w(d,h);return}}c?l.apply(null,[d[0],d[1],d[2],d[3],d[4],a,e]):a.body[e]=w(d)});return a}function A(a){var b=!a.el;1==a.type?(b&&(a.el=a.ns?D.createElementNS(Q[a.ns],a.tag):D.createElement(a.tag),a.props&&H(a)),n(a.body)?a.body.forEach(A):b&&p(a.body)&&(a.raw?a.el.innerHTML=a.body:a.el.textContent=a.body)):2==a.type&&b&&(a.el=D.createTextNode(a.body));a.el._node=
a;(b=a.parent)&&b.el&&b.el.childNodes[a.idx]!==a.el&&b.el.insertBefore(a.el,b.el.childNodes[a.idx])}function P(a,b,d,e,c){var h=n(a),f=h?a[2]||null:a.key,g=d.keyMap,m=b.keyMap;d=d.body;b=b.body;if(null!==f&&g&&p(g[f]))return[g[f],2];e=e||0;if(e>d.length-1)return null;c=0===c?0:c||d.length-1;for(f=null;e<=c;e++)if(g=d[e],null!==g&&g.el)if(h&&g.vm){if(g.vm.view[0]===a[0]){if(g.vm.view[1]===a[1])return[e,2];var l=!1;if(C.viewScan)for(var q=0;q<b.length;q++){var k=b[q];if(!k.el&&k.vm&&k.vm.view[0]===
g.vm.view[0]&&k.vm.view[1]===g.vm.view[1]){l=!0;break}}l||f||!m||p(m[g.key])||(f=[e,1])}}else if(!(a.type!==g.type||2!==a.type&&(null===a.tag||a.tag!==g.tag)||null!==g.key&&m&&p(m[g.key])))return[e,1];return f}function O(a,b){b.el=a.el;a.el=null;if(2===b.type&&b.body!==a.body)b.el.nodeValue=b.body;else{H(b,a);var d=!n(b.body),e=!n(a.body);d&&b.body!==a.body?e&&b.el.firstChild?b.el.firstChild.nodeValue=b.body:b.raw?b.el.innerHTML=b.body:b.el.textContent=b.body:e&&!d&&(b.el.textContent="");a.moved=
!0}}function M(a){if(a in E)return E[a];var b={tag:null,id:null,"class":null};b.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,e,c,h){c&&(b.id=c);h&&(b["class"]=h.replace(/\./g," ").trim());return e||"div"});return E[a]=b}function x(a){return"on"===a.substr(0,2)}function N(a,b){return function(d){var e;if(q(a))e=a.call(b,d);else if(t(a))for(var c in a)d.target.matches(c)&&(e=a[c].call(b,d));!1===e&&(d.preventDefault(),d.stopPropagation())}}function H(a,b){var d=!b;b=b||{};
if(b.props||a.props){var e=b.props||{},c=a.props||{},h=e.style,f=c.style;if(t(h)||t(f))I(a.el,h||{},f||{},R,S,a.ns,d),e.style=c.style=null;I(a.el,e,c,T,J,a.ns,d);f&&(c.style=f)}}function I(a,b,d,e,c,h,f){for(var g in d)null!==d[g]&&(g in b&&d[g]===b[g]||e(a,g,d[g],h,f));for(g in b)null!==b[g]&&(g in d||c(a,g,h,f))}function R(a,b,d){a.style[b]=isNaN(d)||U[b]?d:d+"px"}function S(a,b){a.style[b]=""}function T(a,b,d,e,c){"."===b[0]?(b=b.substr(1),"svg"===e?a[b].baseVal=d:a[b]=d):"class"===b?a.className=
d:"id"===b||x(b)?a[b]=d:!1===d?J(a,b,e,c):(!0===d&&(d=""),a.setAttribute(b,d))}function J(a,b,d,e){e||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||x(b)?a[b]=null:a.removeAttribute(b))}function F(a){var b="";switch(a.type){case 1:b+="<"+a.tag;if(a.props){var d=p(a.props.style)?a.props.style:"",e=t(a.props.style)?a.props.style:null;if(e)for(var c in e)null!==e[c]&&(d+=c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+e[c]+";");for(c in a.props)x(c)||
(e=a.props[c],q(e)&&(e=e()),t(e)||(!0===e?b+=" "+c:!1!==e&&null!==e&&"."!==c[0]&&(b+=" "+c+'="'+e+'"')));d.length&&(b+=' style="'+d+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return b+"/>";b+=">";break;case 2:return a.body}V.test(a.tag)||(n(a.body)?a.body.forEach(function(a){b+=F(a)}):b+=a.body||"",b+="</"+a.tag+">");return b}function n(a){return a instanceof Array}function p(a){a=typeof a;return"string"===a||"number"===a}function t(a){return"object"===typeof a&&null!==a&&!n(a)}function q(a){return"function"===
typeof a}function u(a,b){a.forEach(function(a){return a.apply(null,b)})}function L(a){function b(){d=0;a.apply(e,c)}if(!K.requestAnimationFrame)return a;var d,e,c;return function(){e=this;c=arguments;d||(d=K.requestAnimationFrame(b))}}var Q={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},V=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,E={},K="undefined"==typeof window?{}:window,D="undefined"==typeof document?{}:document,U=
{animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,columnCount:!0,counterIncrement:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexOrder:!0,flexPositive:!0,flexShrink:!0,"float":!0,fontWeight:!0,gridColumn:!0,lineHeight:!0,lineClamp:!0,opacity:!0,order:!0,orphans:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0,tabSize:!0,transform:!0,transformOrigin:!0,widows:!0,zIndex:!0,zoom:!0},C={useRaf:!0,viewScan:!1,useDOM:!1};l.config=function(a){C=a};return l});
