// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(n){module.exports=n()}||"function"===typeof define&&function(n){define("domvm",n)}||function(n){window.domvm=n()})(function(){function n(a,b,d,f,c,e,h){function g(a,b,d){e&&(e.body[h]=null);e=a;h=b;return m(d,!1)}function m(a,f){c=a||c;var g=k.node,w=k.view[3].render.apply(b,c),r=B(w,e,h,k);r.key=p(d)?d:r.key;r.vm=k;k.node=r;if((w=g)&&(r.type!==g.type||r.tag!==g.tag))var w=null,l=!0;C(r,w);e&&(e.body[h]=r);!1!==f&&(g&&x(g),!g&&
u||y(r),l&&(g.el.parentNode.replaceChild(r.el,g.el),g.el=null));setTimeout(function(){k.refs={};D(r,k);var a=k.view[3].after;a&&a.apply(null,void 0)},0);return k}function t(a){var b=null,d=a.split(":");2==d.length&&(a=d[0],b=+d[1]);var d=Array.prototype.slice.call(arguments,1),c=k.node;if(null!==b){for(;b&&c.parent;)c=c.parent,c.vm&&b--;(b=(b=c.vm?c.vm.view[3].on:null)?b[a]:null)&&b.apply(null,d)}else for(;c&&(!c.vm||!(b=(b=c.vm.view[3].on)?b[a]:null)||!1!==b.apply(null,d));)c=c.parent}var u=!e;l(a)&&
(b=a[1],d=a[2],c=a[4],a=a[0]);var k={node:null,view:[a,b,d],redraw:n.useRaf?K(m):m,emit:t,refs:{},html:function(){return E(k.node)},mount:function(a){y(k.node);a.insertBefore(k.node.el,null);return k},attach:function(a){F(k.node,a);return k},destroy:function(a){if(e)if(a){for(a=h+1;a<e.body.length;a++){var b=e.body[a];b.idx=a-1;b.vm&&b.vm.updIdx(b.idx)}e.body.splice(h,1)}else e.body[h]=null;x(k.node,!0);k.node.vm=null;(a=k.view[3].cleanup)&&a.apply(null,void 0)},moveTo:g,updIdx:function(a){h=a},wrapHandler:function(a,
b){var d=p(b)?function(a){return a.target.matches(b)}:q(b)?b:null,c=function(c){b&&!d(c)||!1!==a.call(c.target,c)||(c.preventDefault(),c.stopPropagation());switch(n.autoRedraw){case 2:m();break;case 1:t.redraw()()}};c._fn=a;return c}};a=a.call(b,k,b,d);a=q(a)?{render:a}:a;a.on=a.on||{};a.on._redraw=m;k.view[3]=a;t.create=function(){var a=arguments;return function(){t.apply(null,a)}};t.redraw=function(a){a=p(a)?a:1E3;t("_redraw:"+a)};return e?g(e,h,c):m(c)}function F(a,b){a.el=b;if(l(a.body))for(var d=
0;d<a.body.length;d++){var f=a.body[d];f&&2===f.type&&""===f.body&&b.insertBefore(document.createTextNode(""),b.childNodes[d]||null);F(f,b.childNodes[d])}}function x(a,b){l(a.body)&&(a.body.forEach(function(a,b){a&&(a.vm?a.vm.destroy():a.el&&a.el.parentNode?a.el.parentNode.removeChild(a.el):x(a))}),a.body=null);b&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function B(a,b,d,f){var c={type:null,name:null,key:null,ref:null,idx:null,parent:null,tag:null,ns:null,guard:!1,props:null,on:null,el:null,
keyMap:null,body:null};if(l(a)&&a.length){c.type=1;switch(a.length){case 2:l(a[1])?c.body=a[1]:u(a[1])?c.props=a[1]:c.body=a[1];break;case 3:c.props=a[1],c.body=a[2]}a=a[0];if(/[.#]/.test(a)){if(a=L(a),c.tag=a.tag,a.id||a.class)c.props=c.props||{},c.props.id=a.id,c.props.class=a.class}else c.tag=a;if(c.props){a=c.props;for(var e in a)v(e)?a[e]=q(a[e])?f.wrapHandler(a[e]):l(a[e])?f.wrapHandler(a[e][0],a[e][1]):null:q(a[e])&&(a[e]=a[e]());if(u(a.style))for(var h in a.style)e=a.style[h],q(e)&&(a.style[h]=
e());c.key=p(a._key)?a._key:p(a._ref)?a._ref:p(a.id)?a.id:p(a.name)?a.name:null;a._ref&&(c.ref=a._ref);a._name&&(c.name=a._name);a._guard&&(c.guard=a._guard);a._ref=a._key=a._name=a._guard=null}}else p(a)&&(c.type=2,c.body=a);c.parent=b;c.idx=d;c.ns=b&&b.ns?b.ns:"svg"===c.tag||"math"===c.tag?c.tag:null;if(l(c.body)){b={};d=!1;h=0;for(var g=c.body.length;h<g;h++){e=c.body[h];var m=null;a=null;l(e)&&l(e[0])&&(g=c.body,g.splice.apply(g,[h,1].concat(e)),g=c.body.length,e=c.body[h]);q(e)&&(e=[e]);l(e)&&
q(e[0])?m=e[2]:(a=B(e,c,h,f),m=a.key);p(m)&&(b[m]=h,d=!0);c.body[h]=a||e}d&&(c.keyMap=b)}return c}function C(a,b){b&&M(b,a);l(a.body)&&a.body.forEach(function(d,f){var c=l(d);if(b){var e=N(d,a,b);if(null!==e){var h=e[1],e=b.body[e[0]];c&&e.vm?2===h?e.vm.moveTo(a,f,d[3]):1===h&&n.apply(null,[d[0],d[1],d[2],d[3],d[4],a,f]):a.body[f]=C(d,e);return}}c&&n.apply(null,[d[0],d[1],d[2],d[3],d[4],a,f])});return a}function y(a){var b=!a.el;1==a.type?(b&&(a.el=a.ns?z.createElementNS(O[a.ns],a.tag):z.createElement(a.tag),
a.vm&&(a.el._vm=a.vm),a.props&&G(a)),l(a.body)?a.body.forEach(function(a,b){y(a)}):b&&p(a.body)&&(a.el.textContent=a.body)):2==a.type&&b&&(a.el=z.createTextNode(a.body));(b=a.parent)&&b.el&&b.el.childNodes[a.idx]!==a.el&&b.el.insertBefore(a.el,b.el.childNodes[a.idx])}function N(a,b,d,f,c){var e=l(a),h=e?a[2]||null:a.key,g=d.keyMap,m=b.keyMap;d=d.body;b=b.body;if(null!==h&&g&&p(g[h]))return[g[h],2];f=f||0;if(f>d.length-1)return null;c=0===c?0:c||d.length-1;for(h=null;f<=c;f++)if(g=d[f],null!==g&&g.el)if(e&&
g.vm){if(g.vm.view[0]===a[0]){if(g.vm.view[1]===a[1])return[f,2];var t=!1;if(n.viewScan)for(var q=0;q<b.length;q++){var k=b[q];if(!k.el&&k.vm&&k.vm.view[0]===g.vm.view[0]&&k.vm.view[1]===g.vm.view[1]){t=!0;break}}t||h||!m||p(m[g.key])||(h=[f,1])}}else if(!(a.type!==g.type||2!==a.type&&(null===a.tag||a.tag!==g.tag)||null!==g.key&&m&&p(m[g.key])))return[f,1];return h}function M(a,b){b.el=a.el;a.el=null;if(2===b.type&&b.body!==a.body)b.el.nodeValue=b.body;else{G(b,a);var d=!l(b.body),f=!l(a.body);d&&
b.body!==a.body?f&&b.el.firstChild?b.el.firstChild.nodeValue=b.body:b.el.textContent=b.body:f&&!d&&(b.el.textContent="")}}function L(a){if(a in A)return A[a];var b={tag:null,id:null,class:null};b.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,f,c,e){c&&(b.id=c);e&&(b.class=e.replace(/\./g," ").trim());return f||"div"});return A[a]=b}function v(a){return"on"===a.substr(0,2)}function G(a,b){var d=!b;b=b||{};if(b.props||a.props){var f=b.props||{},c=a.props||{},e=f.style,h=c.style;
if(u(e)||u(h))H(a.el,e||{},h||{},P,Q,a.ns,d),f.style=c.style=null;H(a.el,f,c,R,I,a.ns,d);h&&(c.style=h)}}function H(a,b,d,f,c,e,h){for(var g in d)null!==d[g]&&(g in b&&(v(g)?d[g]._fn===b[g]._fn:d[g]===b[g])||f(a,g,d[g],e,h));for(g in b)null!==b[g]&&(g in d||c(a,g,e,h))}function P(a,b,d){a.style[b]=d}function Q(a,b){a.style[b]=""}function R(a,b,d,f,c){"."===b[0]?(b=b.substr(1),"svg"===f?a[b].baseVal=d:a[b]=d):"class"===b?a.className=d:"id"===b||v(b)?a[b]=d:!1===d?I(a,b,f,c):(!0===d&&(d=""),f?a.setAttributeNS(null,
b,d):a.setAttribute(b,d))}function I(a,b,d,f){f||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||v(b)?a[b]=null:d?a.removeAttributeNS(null,b):a.removeAttribute(b))}function D(a,b){var d=(a.vm||b).refs;null!==a.ref&&a.el&&(d[a.ref]=a.el);l(a.body)&&a.body.forEach(function(d){D(d,a.vm||b)})}function E(a){var b="";switch(a.type){case 1:b+="<"+a.tag;if(a.props){var d=p(a.props.style)?a.props.style:"",f=u(a.props.style)?a.props.style:null;if(f)for(var c in f)null!==
f[c]&&(d+=c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+f[c]+";");for(c in a.props)v(c)||(f=a.props[c],q(f)&&(f=f()),u(f)||(!0===f?b+=" "+c:!1!==f&&null!==f&&"."!==c[0]&&(b+=" "+c+'="'+f+'"')));d.length&&(b+=' style="'+d+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return b+"/>";b+=">";break;case 2:return a.body}S.test(a.tag)||(l(a.body)?a.body.forEach(function(a){b+=E(a)}):b+=a.body||"",b+="</"+a.tag+">");return b}function l(a){return Array.isArray(a)}function p(a){var b=typeof a;
return"string"===b||"number"===b&&!isNaN(a)&&Infinity!==a}function u(a){return"[object Object]"===Object.prototype.toString.call(a)}function q(a){return"function"===typeof a}function K(a){function b(){d=0;a.apply(f,c)}if(!J.requestAnimationFrame)return a;var d,f,c;return function(){f=this;c=arguments;d||(d=J.requestAnimationFrame(b))}}var O={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},S=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,
A={},J="undefined"==typeof window?{}:window,z=document;n.viewScan=!1;n.useRaf=!0;n.autoRedraw=0;return n});
