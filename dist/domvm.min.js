// https://github.com/leeoniya/domvm
("object"===typeof module&&"object"===typeof module.exports&&function(l){module.exports=l()}||"function"===typeof define&&function(l){define("domvm",l)}||function(l){window.domvm=l()})(function(){function l(a,b,d,c,e,f,h){function g(a,b,d){f&&(f.body[h]=null);f=a;h=b;return q(d,!1)}function q(a,b){e=a||e;var c=k.node,g=k.view[3].render.apply(null,e),r=A(g,f,h,k);r.key=n(d)?d:r.key;r.vm=k;k.node=r;if((g=c)&&(r.type!==c.type||r.tag!==c.tag))var g=null,m=!0;B(r,g);f&&(f.body[h]=r);!1!==b&&(c&&w(c),!c&&
J||x(r),m&&(c.el.parentNode.replaceChild(r.el,c.el),c.el=null));setTimeout(function(){k.refs={};C(r,k);var a=k.view[3].after;a&&a.apply(null,void 0)},0);return k}function t(a){var b=null,c=a.split(":");2==c.length&&(a=c[0],b=+c[1]);var c=Array.prototype.slice.call(arguments,1),d=k.node;if(null!==b){for(;b&&d.parent;)d=d.parent,d.vm&&b--;(b=(b=d.vm?d.vm.view[3].on:null)?b[a]:null)&&b.apply(null,c)}else for(;d&&(!d.vm||!(b=(b=d.vm.view[3].on)?b[a]:null)||!1!==b.apply(null,c));)d=d.parent}var J=!f;m(a)&&
(b=a[1],d=a[2],e=a[4],a=a[0]);var k={node:null,view:[a,b,d],redraw:l.useRaf?K(q):q,emit:t,refs:{},html:function(){return D(k.node)},mount:function(a){x(k.node);a.insertBefore(k.node.el,null);return k},attach:function(a){E(k.node,a);return k},destroy:function(a){if(f)if(a){for(a=h+1;a<f.body.length;a++){var b=f.body[a];b.idx=a-1;b.vm&&b.vm.updIdx(b.idx)}f.body.splice(h,1)}else f.body[h]=null;w(k.node,!0);k.node.vm=null;(a=k.view[3].cleanup)&&a.apply(null,void 0)},moveTo:g,updIdx:function(a){h=a},wrapHandler:function(a,
b){var d=n(b)?function(a){return a.target.matches(b)}:p(b)?b:null,c=function(c){b&&!d(c)||!1!==a.call(c.target,c)||(c.preventDefault(),c.stopPropagation());switch(l.autoRedraw){case 2:q();break;case 1:t.redraw()()}};c._fn=a;return c}};a=a(k,b,d);a=p(a)?{render:a}:a;a.on=a.on||{};a.on._redraw=q;k.view[3]=a;t.create=function(){var a=arguments;return function(){t.apply(null,a)}};t.redraw=function(a){a=n(a)?a:1E3;return function(){t("_redraw:"+a)}};return f?g(f,h,e):q(e)}function E(a,b){a.el=b;if(m(a.body))for(var d=
0;d<a.body.length;d++){var c=a.body[d];c&&2===c.type&&""===c.body&&b.insertBefore(document.createTextNode(""),b.childNodes[d]||null);E(c,b.childNodes[d])}}function w(a,b){m(a.body)&&(a.body.forEach(function(a,b){a&&(a.vm?a.vm.destroy():a.el&&a.el.parentNode?a.el.parentNode.removeChild(a.el):w(a))}),a.body=null);b&&a.el&&(a.el.parentNode.removeChild(a.el),a.el=null)}function A(a,b,d,c){var e=L(a,c);e.parent=b;e.idx=d;e.ns=b&&b.ns?b.ns:"svg"===e.tag||"math"===e.tag?e.tag:null;if(m(e.body)){var f={},
h=!1;e.body.forEach(function(a,b){var d=null,l=null;p(a)&&(a=[a]);m(a)&&p(a[0])?d=a[2]:(l=A(a,e,b,c),d=l.key);n(d)&&(f[d]=b,h=!0);e.body[b]=l||a});h&&(e.keyMap=f)}return e}function B(a,b){b&&M(b,a);m(a.body)&&a.body.forEach(function(d,c){var e=m(d);if(b){var f=N(d,a,b);if(null!==f){var h=f[1],f=b.body[f[0]];e&&f.vm?2===h?f.vm.moveTo(a,c,d[3]):1===h&&l.apply(null,[d[0],d[1],d[2],d[3],d[4],a,c]):a.body[c]=B(d,f);return}}e&&l.apply(null,[d[0],d[1],d[2],d[3],d[4],a,c])});return a}function x(a){var b=
!a.el;1==a.type?(b&&(a.el=a.ns?y.createElementNS(O[a.ns],a.tag):y.createElement(a.tag),a.vm&&(a.el._vm=a.vm),a.props&&F(a)),m(a.body)?a.body.forEach(function(a,b){x(a)}):b&&n(a.body)&&(a.el.textContent=a.body)):2==a.type&&b&&(a.el=y.createTextNode(a.body));(b=a.parent)&&b.el&&b.el.childNodes[a.idx]!==a.el&&b.el.insertBefore(a.el,b.el.childNodes[a.idx])}function N(a,b,d,c,e){var f=m(a),h=f?a[2]||null:a.key,g=d.keyMap,q=b.keyMap;d=d.body;b=b.body;if(null!==h&&g&&n(g[h]))return[g[h],2];c=c||0;if(c>d.length-
1)return null;e=0===e?0:e||d.length-1;for(h=null;c<=e;c++)if(g=d[c],null!==g&&g.el)if(f&&g.vm){if(g.vm.view[0]===a[0]){if(g.vm.view[1]===a[1])return[c,2];var t=!1;if(l.viewScan)for(var p=0;p<b.length;p++){var k=b[p];if(!k.el&&k.vm&&k.vm.view[0]===g.vm.view[0]&&k.vm.view[1]===g.vm.view[1]){t=!0;break}}t||h||!q||n(q[g.key])||(h=[c,1])}}else if(!(a.type!==g.type||2!==a.type&&(null===a.tag||a.tag!==g.tag)||null!==g.key&&q&&n(q[g.key])))return[c,1];return h}function M(a,b){b.el=a.el;a.el=null;if(2===b.type&&
b.body!==a.body)b.el.nodeValue=b.body;else{F(b,a);var d=!m(b.body),c=!m(a.body);d&&b.body!==a.body?c&&b.el.firstChild?b.el.firstChild.nodeValue=b.body:b.el.textContent=b.body:c&&!d&&(b.el.textContent="")}}function P(a){if(a in z)return z[a];var b={tag:null,id:null,class:null};b.tag=a.replace(/^([\w\-]+)?(?:#([\w\-]+))?((?:\.[\w\-]+)+)?$/,function(a,c,e,f){e&&(b.id=e);f&&(b.class=f.replace(/\./g," ").trim());return c||"div"});return z[a]=b}function L(a,b){var d={type:null,name:null,key:null,ref:null,
idx:null,parent:null,tag:null,ns:null,guard:!1,props:null,on:null,el:null,keyMap:null,body:null};if(m(a)&&a.length){d.type=1;switch(a.length){case 2:m(a[1])?d.body=a[1]:u(a[1])?d.props=a[1]:d.body=a[1];break;case 3:d.props=a[1];d.body=a[2];break}var c=a[0];if(/[.#]/.test(c)){if(c=P(c),d.tag=c.tag,c.id||c.class)d.props=d.props||{},d.props.id=c.id,d.props.class=c.class}else d.tag=c;if(d.props){var c=d.props,e;for(e in c)v(e)?c[e]=p(c[e])?b.wrapHandler(c[e]):m(c[e])?b.wrapHandler(c[e][0],c[e][1]):null:
p(c[e])&&(c[e]=c[e]());if(u(c.style))for(var f in c.style)e=c.style[f],p(e)&&(c.style[f]=e());d.key=n(c._key)?c._key:n(c._ref)?c._ref:n(c.id)?c.id:n(c.name)?c.name:null;c._ref&&(d.ref=c._ref);c._name&&(d.name=c._name);c._guard&&(d.guard=c._guard);c._ref=c._key=c._name=c._guard=null}}else n(a)&&(d.type=2,d.body=a);return d}function v(a){return"on"===a.substr(0,2)}function F(a,b){var d=!b;b=b||{};if(b.props||a.props){var c=b.props||{},e=a.props||{},f=c.style,h=e.style;if(u(f)||u(h))G(a.el,f||{},h||
{},Q,R,a.ns,d),c.style=e.style=null;G(a.el,c,e,S,H,a.ns,d);h&&(e.style=h)}}function G(a,b,d,c,e,f,h){for(var g in d)null!==d[g]&&(g in b&&(v(g)?d[g]._fn===b[g]._fn:d[g]===b[g])||c(a,g,d[g],f,h));for(g in b)null!==b[g]&&(g in d||e(a,g,f,h))}function Q(a,b,d){a.style[b]=d}function R(a,b){a.style[b]=""}function S(a,b,d,c,e){"."===b[0]?(b=b.substr(1),"svg"===c?a[b].baseVal=d:a[b]=d):"class"===b?a.className=d:"id"===b||v(b)?a[b]=d:!1===d?H(a,b,c,e):(!0===d&&(d=""),c?a.setAttributeNS(null,b,d):a.setAttribute(b,
d))}function H(a,b,d,c){c||("."===b[0]?(b=b.substr(1),"svg"===d?a[b].baseVal=null:a[b]=null):"class"===b?a.className="":"id"===b||v(b)?a[b]=null:d?a.removeAttributeNS(null,b):a.removeAttribute(b))}function C(a,b){var d=(a.vm||b).refs;null!==a.ref&&a.el&&(d[a.ref]=a.el);m(a.body)&&a.body.forEach(function(c){C(c,a.vm||b)})}function D(a){var b="";switch(a.type){case 1:b+="<"+a.tag;if(a.props){var d=n(a.props.style)?a.props.style:"",c=u(a.props.style)?a.props.style:null;if(c)for(var e in c)null!==c[e]&&
(d+=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+": "+c[e]+";");for(e in a.props)v(e)||(c=a.props[e],p(c)&&(c=c()),u(c)||(!0===c?b+=" "+e:!1!==c&&null!==c&&"."!==e[0]&&(b+=" "+e+'="'+c+'"')));d.length&&(b+=' style="'+d+'"')}if(a.ns&&"svg"!==a.tag&&"math"!==a.tag&&!a.body)return b+"/>";b+=">";break;case 2:return a.body}T.test(a.tag)||(m(a.body)?a.body.forEach(function(a){b+=D(a)}):b+=a.body||"",b+="</"+a.tag+">");return b}function m(a){return Array.isArray(a)}function n(a){var b=typeof a;return"string"===
b||"number"===b&&!isNaN(a)&&Infinity!==a}function u(a){return"[object Object]"===Object.prototype.toString.call(a)}function p(a){return"function"===typeof a}function K(a){function b(){d=0;a.apply(c,e)}if(!I.requestAnimationFrame)return a;var d,c,e;return function(){c=this;e=arguments;d||(d=I.requestAnimationFrame(b))}}var O={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},T=/^(?:img|br|input|col|link|meta|area|base|command|embed|hr|keygen|param|source|track|wbr)$/,z={},
I="undefined"==typeof window?{}:window,y=document;l.viewScan=!1;l.useRaf=!0;l.autoRedraw=0;return l});
